{"version":3,"sources":["modules/error.ts","modules/http.ts","modules/snapshot/index.ts","interfaces.ts","utils.ts","modules/hero/data.ts","modules/hero/index.ts","modules/hero/sorters.ts","modules/equip/sorters.ts","modules/equip/data.ts","modules/equip/attr.ts","modules/equip/score.ts","modules/equip/index.ts","components/Common/Star.tsx","store.ts","components/Snapshot/SnapshotInfo.tsx","components/Overview/OverviewPage.tsx","components/Common/SubNav.tsx","components/Hero/HeroIcon.tsx","constants.ts","components/Hero/HeroGrid.tsx","components/Common/Rarity.tsx","components/Common/Rating.tsx","components/Equip/EquipIcon.tsx","components/Equip/EquipDetail.tsx","components/Equip/EquipItem.tsx","components/Equip/EquipSet.tsx","components/Equip/Equips.tsx","components/Hero/HeroDetail.tsx","components/Hero/HeroDetailOverlay.tsx","hooks/debounce.ts","components/Hero/HeroList.tsx","modules/shard/index.ts","components/Hero/Shard/ShardPage.tsx","modules/skill/data.ts","components/Hero/Skill/SkillPage.tsx","components/Hero/HeroPage.tsx","components/Equip/EquipGrid.tsx","components/Equip/EquipTypeSelector.tsx","components/Equip/EquipPosition.tsx","modules/equip/export.ts","modules/equip/ocr2.ts","components/Equip/EquipList.tsx","components/Equip/EquipSetAttrs.tsx","components/Equip/EquipPage.tsx","components/Equip/EquipPresets.tsx","modules/realm_card/data.ts","modules/realm_card/index.ts","components/RealmCard/RealmCardPage.tsx","components/Update/UpdateInfo.tsx","components/About/About.tsx","components/Main/Main.tsx","components/Snapshot/SnapshotSelectScreen.tsx","components/App.tsx","serviceWorker.ts","index.tsx","assets/logo.svg"],"names":["ActionType","initialState","currentError","ErrorActions","error","type","SetError","payload","HttpClient","axios","create","interceptors","response","use","res","err","data","message","Error","concat","status","extractError","YyxStore","dispatch","Promise","reject","currentNotSelected","current","Ratings","HeroRarity","HeroEquipAttrType","SnapshotSelectors","state","snapshot","SnapshotActions","select","file","_ref","Object","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","put","loadCurrent","stop","this","_x","apply","arguments","resetCurrent","SetCurrent","_ref2","_callee2","_context2","t0","t1","get","then","t2","sent","t3","_x2","AttrValueType","combineSorters","_len","length","sorters","Array","_key","b","_i","r","sorter","combineFilters","_len2","filters","_key2","v","_i2","filter","sortDesc","formatAttrValue","undefined","Float","toFixed","Percentage","Math","round","DATE_FORMAT","formatTimestamp","moment","Date","setTime","local","format","getTimestampFromObjectId","id","parseInt","substring","formatDate","date","parseDate","str","locale","toDate","computeOnce","f","value","DATA","require","mapAttrRating","list","attack","max_hp","defense","speed","crit_rate","ALL_HERO_DATA","map","i","name","attr_rating","unawake","awake","rarity","skills","awake_skill","DataMap","reduce","m","set","Map","RarityRank","SP","SSR","SR","R","N","reverse","getHeroData","heroId","defaultSorter","star","level","hero_id","listOptions","HeroActions","opts","SetListOptions","materialRarityFilter","hero","includes","selectAll","heroes","timestamp_from_id","selectMapById","createSelector","selectAllSorted","slice","sort","selectMapByHeroId","push","FORCE_FOLD_HERO_IDS","selectAllFolded","skipped","groups","lock","nick_name","group","item","find","gi","folded","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","values","Symbol","iterator","done","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","vi","return","selectListOptions","createTermFilter","term","trim","heroIds","selectList","sorted","toConsumableArray","fold","HeroSelectors","selectCount","l","quality","suit_id","ALL_SUIT_DATA","getEquipSuiteData","AttrNames","_AttrNames","defineProperty","Hp","Defense","Attack","HpRate","DefenseRate","AttackRate","Speed","CritRate","CritPower","EffectHitRate","EffectResistRate","PercentageAttrs","HeroEquipPosAttrBaseTypes","formatEquipAttrValue","plus","formatEquipAttr","getEquipAttrName","getEquipRandomAttrValue","equip","random_attr_map","random_attrs","attr","round2","AttrValueRounders","SCORE_DATA","match","attrs","_ref3","slicedToArray","reqType","reqValue","getEquipScoreData","score","EquipActions","EquipLevelFilter","EquipEquippedFilter","selectEquippedByMap","equippedByMap","h","equips","selectPresets","hero_equip_presets","selectIncludedInPresetsMap","presets","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","p","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","items","equippedBy","inPresets","hero_equips","suit_data","equipped_by","included_in_presets","selectMaps","idMap","qualityMap","levelMap","suitMap","posMap","baseAttrMap","selector","key","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","e","pos","base_attr","suit","StarType","selectDisplay","types","positions","stars","baseAttrs","Any","Zero","equipped","Equipped","trashed","garbage","scores","scoreData","creationTimeFrom","t","getTime","creationTimeTo","EquipSelectors","selectPresetItems","maps","objectSpread","suitCount","attrMap","suits","clear","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_step9","_iterator9","single_attrs","c","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_iterator7","entries","suitId","count","effect","_iteratorNormalCompletion10","_didIteratorError10","_iteratorError10","_step10","_iterator10","console","warn","computeEquipSetInfo","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","createStore","combineReducers","action","applyMiddleware","thunk","SnapshotInfo","connect","notSelected","stateProps","dispatchProps","ownProps","render","props","info","_info$data","player","currency","react_default","createElement","className","version","timestamp","coin","jade","action_point","handleLinkClick","route","link","preventDefault","history","to","SubNav","withRouter","path","location","pathname","menu","large","links","menuItem","active","text","label","href","onClick","renderStar","classNames","Elements","_Elements","Orange","Purple","Blue","orangeElems","purpleElems","blueElems","ii","Grey","Stars","getStarType","HeroIcon","toLowerCase","childHeros","onClickHero","src","Star_Stars","HeroDataIcon","HeroGrid","idx","HeroIcon_HeroIcon","ClassNames","_ClassNames","Rarity","Rating","rating","EquipIcon","EquipIcon_EquipTypeIcon","EquipTypeIcon","_ref$size","size","width","height","EquipDetail","_formatEquipAttr","_formatEquipAttr2","baseAttrName","baseAttrValue","EquipIcon_EquipIcon","Fragment","_formatEquipAttr3","_formatEquipAttr4","_formatEquipAttr5","_formatEquipAttr6","target","EquipItem","popover","content","EquipDetail_EquipDetail","minimal","popoverClassName","Classes","POPOVER_CONTENT_SIZING","portalClassName","onClickEquip","EquipSet","_useState","useState","_useState2","setItems","useEffect","fill","EquipItem_EquipItem","Equips","ids","HeroDetail","ratings","Rarity_Rarity","style","flex","renderIconName","Rating_Rating","base","crit_power","effect_hit_rate","effect_resist_rate","renderAttrs","EquipSet_EquipSet","HeroDetailOverlay","contentEl","useRef","overlay","backdropClassName","isOpen","onClose","classList","add","ref","HeroDetail_HeroDetail","useDebounce","delay","debouncedValue","setDebouncedValue","handler","setTimeout","clearTimeout","RaritySelect","Select","ofType","RarityOptions","getRarityElem","option","renderRarityOption","params","handleClick","modifiers","StarSelect","StarOptions","renderStarOption","HeroList","mapById","activeHero","setActiveHero","_useState3","_useState4","setFold","_useState5","_useState6","setRarity","_useState7","_useState8","setStar","_useState9","_useState10","setTerm","debouncedTerm","HeroDetailOverlay_HeroDetailOverlay","card","inputGroup","leftIcon","placeholder","onChange","filterable","itemRenderer","onItemSelect","buttons","controls","checked","HeroGrid_HeroGrid","log","hero_book_shards","hero_data","getRarityRank","s","ShardSelectors","selectSorted","shards","books","ShardPage","justifyContent","book_max_shards","getSkillMaxLevelMap","SKILL_LEVEL_DATA","getDataList","SkillMaxLevelMap","all_skills","skill_max_levels","SubPages","component","heroesMap","HeroIcon_HeroDataIcon","numbers","skill","max","color","formatUpgrade","EquipGrid","EquipTypeDialog","dialog","onCancel","DIALOG_BODY","selected","setIdSelected","tag","attr2","getEquipSuitAttrName","icon","DIALOG_FOOTER","DIALOG_FOOTER_ACTIONS","intent","Intent","PRIMARY","onOk","EmptyList","EquipTypeMultiSelector","dialogOpen","setDialogOpen","dialogSelected","setDialogSelected","setSelected","EquipTypeSelector_EquipTypeDialog","multiple","idSelected","Labels","EquipPosition","position","labelElement","exportJson","filename","post","AttrNameMap","SuitMap","String","equipsToOcr2","御魂ID","御魂等级","御魂星级","御魂类型","位置","_arr","keys","forEach","k","renderBaseAttrs","disabled","alignText","from","Set","getBaseAttrList","buttonGroup","DefaultListOptions","Max","exportOcr2Json","snapshotInfo","abrupt","EquipList","options","_setOptions","debouncedOptions","loading","setLoading","exporting","setExporting","exported","setExported","setOptions","divider","EquipTypeSelector_EquipTypeMultiSelector","nodes","_loop","EquipPosition_EquipPosition","renderPositions","_loop2","renderStars","NotEquipped","dateInput","showActionsBar","timePrecision","callout","EquipGrid_EquipGrid","AttrTable","EquipSetAttrs","suites","setSuites","termDebounced","setList","filteredList","some","every","EquipSetAttrs_EquipSetAttrs","RealmCardNames","realm_cards","itemId","item_id","selectGroupMapByName","cards","entry","RealmCardSelectors","selectGroups","RealmCardPage","columns","rows","g","os","family","Markdown","MyTargets","R_FILENAME","ReleaseInfo","release","tag_name","source","body","assets","browser_download_url","asset","parts","_parts","product","myTarget","productName","replace","getAssetElement","UpdateInfo","latest","setLatest","setError","race","pkg","draft","prerelease","spinner","defaultIsOpen","UpdateInfo_ReleaseInfo","About","logo","routes","renderLabel","SubNav_SubNav","page","react_router","exact","LayoutImpl","navbar","navbarGroup","align","Alignment","LEFT","navbarDivider","startsWith","RIGHT","UpdateInfo_UpdateInfo","About_About_About","Main","react_router_dom","SnapshotSelectScreen","title","fileInput","onInputChange","files","catch","App","load","main","Main_Main_Main","SnapshotSelectScreen_SnapshotSelectScreen","marginTop","Boolean","hostname","container","document","getElementById","ReactDOM","es","store","components_App","navigator","serviceWorker","ready","registration","unregister","module","exports","__webpack_require__"],"mappings":"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","file":"static/js/main.f3094119.chunk.js","sourcesContent":["import { IAction } from \"../store\";\r\n\r\nexport interface IState {\r\n  currentError: Error | null;\r\n}\r\n\r\nconst initialState: IState = {\r\n  currentError: null\r\n};\r\n\r\nexport enum ActionType {\r\n  SetError = \"ERROR_SET_ERROR\"\r\n}\r\n\r\nexport function reducer(state = initialState, action: IAction<ActionType>) {\r\n  const { type, payload } = action;\r\n  switch (type) {\r\n    case ActionType.SetError:\r\n      return {\r\n        ...state,\r\n        currentError: payload\r\n      };\r\n  }\r\n  return state;\r\n}\r\n\r\nexport const ErrorActions = {\r\n  setError(error: Error) {\r\n    return {\r\n      type: ActionType.SetError,\r\n      payload: error\r\n    };\r\n  },\r\n  clearError() {\r\n    return {\r\n      type: ActionType.SetError,\r\n      payload: null\r\n    };\r\n  }\r\n};\r\n","import axios, { AxiosResponse } from \"axios\";\r\nimport { YyxStore } from \"../store\";\r\nimport { ErrorActions } from \"./error\";\r\n\r\nexport const HttpClient = axios.create();\r\n\r\nHttpClient.interceptors.response.use(\r\n  res => res,\r\n  err => {\r\n    const error = err.response ? extractError(err.response) : err;\r\n    YyxStore.dispatch(ErrorActions.setError(error));\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nfunction extractError(res: AxiosResponse) {\r\n  if (res.data && res.data.message) {\r\n    return new Error(res.data.message);\r\n  }\r\n  return new Error(`未知错误 (HTTP ${res.status})`);\r\n}\r\n","import { IAction, IDispatch, IYyxState } from \"../../store\";\r\nimport { HttpClient } from \"../http\";\r\nimport { ISnapshot } from \"../../interfaces\";\r\nimport { HeroActions } from \"../hero\";\r\n\r\nexport interface IState {\r\n  currentNotSelected: boolean;\r\n  current: ISnapshot | null;\r\n}\r\n\r\nconst initialState: IState = {\r\n  currentNotSelected: false,\r\n  current: null\r\n};\r\n\r\nexport enum ActionType {\r\n  SetCurrent = \"SNAPSHOT_SET_CURRENT\"\r\n}\r\n\r\nexport function reducer(state = initialState, action: IAction<ActionType>) {\r\n  const { type, payload } = action;\r\n  switch (type) {\r\n    case ActionType.SetCurrent:\r\n      return {\r\n        ...state,\r\n        currentNotSelected: !payload,\r\n        current: payload\r\n      };\r\n  }\r\n  return state;\r\n}\r\n\r\nconst selectCurrentSnapshot = (state: IYyxState) =>\r\n  state.snapshot && state.snapshot.current;\r\n\r\nexport const SnapshotSelectors = {\r\n  selectCurrentSnapshot\r\n};\r\n\r\nexport const SnapshotActions = {\r\n  select(file: File) {\r\n    return async (dispatch: IDispatch<ActionType>) => {\r\n      await HttpClient.put(\"/api/snapshot\", file);\r\n      dispatch(SnapshotActions.loadCurrent());\r\n    };\r\n  },\r\n  resetCurrent() {\r\n    return (dispatch: IDispatch) => {\r\n      dispatch({\r\n        type: ActionType.SetCurrent,\r\n        payload: null\r\n      });\r\n    };\r\n  },\r\n  loadCurrent() {\r\n    return async (dispatch: IDispatch<ActionType>) => {\r\n      dispatch({\r\n        type: ActionType.SetCurrent,\r\n        payload: await HttpClient.get(\"/api/snapshot\").then(res => res.data)\r\n      });\r\n    };\r\n  }\r\n};\r\n","import { number } from \"prop-types\";\r\n\r\nexport interface IPlayer {\r\n  id: number;\r\n  name: string;\r\n  level: string;\r\n}\r\n\r\nexport interface IPlayerCurrency {\r\n  coin: number;\r\n  jade: number;\r\n  action_point: number;\r\n}\r\n\r\nexport interface IHero {\r\n  id: string;\r\n  hero_id: number;\r\n  equips: string[];\r\n  level: number;\r\n  awake: number;\r\n  star: number;\r\n  exp: number;\r\n  exp_rate: number;\r\n  nick_name: string;\r\n  born: number;\r\n  lock: boolean;\r\n  rarity: HeroRarity;\r\n  skills: HeroSkill[];\r\n  attrs: IHeroAttrs;\r\n  data?: IHeroData;\r\n  timestamp_from_id?: number;\r\n}\r\n\r\nexport interface IHeroAttrs {\r\n  max_hp: IHeroAttr;\r\n  speed: IHeroAttr;\r\n  crit_power: IHeroAttr;\r\n  crit_rate: IHeroAttr;\r\n  defense: IHeroAttr;\r\n  attack: IHeroAttr;\r\n  effect_hit_rate: number;\r\n  effect_resist_rate: number;\r\n}\r\n\r\nexport interface IHeroAttr {\r\n  base: number;\r\n  add_value: number;\r\n  add_rate: number;\r\n  value: number;\r\n}\r\n\r\nexport interface IHeroData {\r\n  id: number;\r\n  name: string;\r\n  attr_rating: {\r\n    unawake: IHeroAttrRating;\r\n    awake: IHeroAttrRating;\r\n  };\r\n  rarity: HeroRarity;\r\n  skills: number[];\r\n  awake_skill: number | null;\r\n  awake_base_attrs: { [level: string]: IHeroAttrs }\r\n}\r\n\r\nexport enum Ratings {\r\n  SS = \"ss\",\r\n  S = \"s\",\r\n  A = \"a\",\r\n  B = \"b\",\r\n  C = \"c\",\r\n  D = \"d\"\r\n}\r\n\r\nexport interface IHeroAttrRating {\r\n  attack: Ratings;\r\n  max_hp: Ratings;\r\n  defense: Ratings;\r\n  speed: Ratings;\r\n  crit_rate: Ratings;\r\n}\r\n\r\nexport enum HeroRarity {\r\n  N = \"N\",\r\n  R = \"R\",\r\n  SR = \"SR\",\r\n  SSR = \"SSR\",\r\n  SP = \"SP\"\r\n}\r\n\r\nexport interface HeroSkill {\r\n  id: number;\r\n  level: number;\r\n}\r\n\r\nexport interface IHeroEquip {\r\n  id: string;\r\n  suit_id: number;\r\n  quality: number;\r\n  pos: number;\r\n  equip_id: number;\r\n  level: number;\r\n  born: number;\r\n  lock: boolean;\r\n  garbage: boolean;\r\n  attrs: IHeroEquipAttr[];\r\n  base_attr: IHeroEquipAttr;\r\n  random_attrs: IHeroEquipAttr[];\r\n  random_attr_rates: IHeroEquipAttr[];\r\n  single_attrs: IHeroEquipAttr[];\r\n  suit_data?: IHeroEquipSuitData;\r\n  equipped_by?: IHero;\r\n  included_in_presets?: IHeroEquipPreset[];\r\n  timestamp_from_id?: number;\r\n  random_attr_map?: Map<HeroEquipAttrType, number>;\r\n}\r\n\r\nexport interface IHeroEquipSuitData {\r\n  id: number;\r\n  name: string;\r\n  attr: [\r\n    IHeroEquipSuiteAttr[],\r\n    IHeroEquipSuiteAttr[],\r\n    IHeroEquipSuiteAttr[],\r\n    IHeroEquipSuiteAttr[]\r\n  ];\r\n  effect: [string[], string[], string[], string[]];\r\n}\r\n\r\nexport interface IHeroEquipSuiteAttr {\r\n  type: HeroEquipAttrType;\r\n  value: number;\r\n}\r\n\r\nexport interface IHeroEquipAttr {\r\n  type: HeroEquipAttrType;\r\n  value: number;\r\n}\r\n\r\nexport enum HeroEquipAttrType {\r\n  Hp = \"Hp\",\r\n  Defense = \"Defense\",\r\n  Attack = \"Attack\",\r\n  HpRate = \"HpRate\",\r\n  DefenseRate = \"DefenseRate\",\r\n  AttackRate = \"AttackRate\",\r\n  Speed = \"Speed\",\r\n  CritRate = \"CritRate\",\r\n  CritPower = \"CritPower\",\r\n  EffectHitRate = \"EffectHitRate\",\r\n  EffectResistRate = \"EffectResistRate\"\r\n}\r\n\r\nexport interface IHeroEquipPreset {\r\n  name: string;\r\n  items: string[];\r\n}\r\n\r\nexport interface IHeroBookShard {\r\n  hero_id: number;\r\n  shards: number;\r\n  books: number;\r\n  book_max_shards: number;\r\n  hero_data?: IHeroData;\r\n}\r\n\r\nexport interface IRealmCard {\r\n  id: string;\r\n  item_id: number;\r\n  total_time: number;\r\n  attrs: {\r\n    exp: number;\r\n    bonus: number;\r\n  };\r\n  data?: IRealmCardData;\r\n}\r\n\r\nexport interface IRealmCardData {\r\n  id: number;\r\n  name: string;\r\n  star: number;\r\n}\r\n\r\nexport interface ISnapshot {\r\n  version: string;\r\n  timestamp: string;\r\n  data: {\r\n    player: IPlayer;\r\n    currency: IPlayerCurrency;\r\n    heroes: IHero[];\r\n    hero_equips: IHeroEquip[];\r\n    hero_equip_presets: IHeroEquipPreset[];\r\n    hero_book_shards: IHeroBookShard[];\r\n    realm_cards: IRealmCard[];\r\n  };\r\n}\r\n","import moment from \"moment\";\r\n\r\nexport type Sorter<T> = (a: T, b: T) => number;\r\nexport type Filter<T> = (v: T) => boolean;\r\n\r\nexport function combineSorters<T>(...sorters: Array<Sorter<T>>): Sorter<T> {\r\n  return (a, b) => {\r\n    for (let sorter of sorters) {\r\n      const r = sorter(a, b);\r\n      if (r !== 0) {\r\n        return r;\r\n      }\r\n    }\r\n    return 0;\r\n  };\r\n}\r\n\r\nexport function combineFilters<T>(...filters: Array<Filter<T>>): Filter<T> {\r\n  return v => {\r\n    for (let filter of filters) {\r\n      const r = filter(v);\r\n      if (!r) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  };\r\n}\r\n\r\nexport function sortDesc<T>(sorter: Sorter<T>): Sorter<T> {\r\n  return (a, b) => -sorter(a, b);\r\n}\r\n\r\nexport enum AttrValueType {\r\n  Float,\r\n  Percentage\r\n}\r\n\r\nexport function formatAttrValue(\r\n  v: number,\r\n  type: AttrValueType = AttrValueType.Float\r\n): string {\r\n  switch (type) {\r\n    case AttrValueType.Float:\r\n      return v.toFixed(2);\r\n    case AttrValueType.Percentage:\r\n      return `${(Math.round(v * 10000) / 100).toFixed(2)}%`;\r\n  }\r\n}\r\n\r\nconst DATE_FORMAT = \"YYYY-MM-DD HH:mm\";\r\n\r\nexport function formatTimestamp(v?: number) {\r\n  if (!v) return \"很久以前\";\r\n  return moment(new Date().setTime(v * 1000))\r\n    .local()\r\n    .format(DATE_FORMAT);\r\n}\r\n\r\nexport function getTimestampFromObjectId(id: string) {\r\n  return parseInt(id.substring(0, 8), 16);\r\n}\r\n\r\nexport function formatDate(date: string | Date, format = DATE_FORMAT) {\r\n  return moment(date)\r\n    .local()\r\n    .format(format);\r\n}\r\n\r\nexport function parseDate(str: string, locale?: string) {\r\n  return moment(str, DATE_FORMAT).toDate();\r\n}\r\n\r\nexport function computeOnce<T>(f: () => T): () => T {\r\n  let value: T | null = null;\r\n  return () => {\r\n    if (!value) {\r\n      value = f();\r\n    }\r\n    return value;\r\n  };\r\n}\r\n","import { IHeroAttrRating, IHeroData, HeroRarity } from \"../../interfaces\";\r\n\r\nexport const DATA = require(\"./HERO_DATA.json\");\r\n\r\nconst mapAttrRating = (list: string[]) => {\r\n  return {\r\n    attack: list[0],\r\n    max_hp: list[1],\r\n    defense: list[2],\r\n    speed: list[3],\r\n    crit_rate: list[4]\r\n  } as IHeroAttrRating;\r\n};\r\n\r\nexport const ALL_HERO_DATA: IHeroData[] = DATA.map((i: any) => {\r\n  return {\r\n    id: i.id,\r\n    name: i.name,\r\n    attr_rating: {\r\n      unawake: mapAttrRating(i.attr_rating[0]),\r\n      awake: mapAttrRating(i.attr_rating[1])\r\n    },\r\n    rarity: i.rarity,\r\n    skills: i.skills,\r\n    awake_skill: i.awake_skill\r\n  };\r\n});\r\n\r\nconst DataMap: Map<number, IHeroData> = ALL_HERO_DATA.reduce(\r\n  (m: Map<number, IHeroData>, i: any) => {\r\n    m.set(i.id, i);\r\n    return m;\r\n  },\r\n  new Map()\r\n);\r\n\r\nexport const RarityRank = [\r\n  HeroRarity.SP,\r\n  HeroRarity.SSR,\r\n  HeroRarity.SR,\r\n  HeroRarity.R,\r\n  HeroRarity.N\r\n]\r\n  .reverse()\r\n  .reduce(\r\n    (m, r, i) => {\r\n      m[r] = i;\r\n      return m;\r\n    },\r\n    {} as { [key in HeroRarity]: number }\r\n  );\r\n\r\nexport const getHeroData = (heroId: number) => DataMap.get(heroId);\r\n","import { IAction, IDispatch, IYyxState } from \"../../store\";\r\nimport { IHero, HeroRarity, IHeroData } from \"../../interfaces\";\r\nimport { createSelector } from \"reselect\";\r\nimport { defaultSorter } from \"./sorters\";\r\nimport { getHeroData, DATA, RarityRank } from \"./data\";\r\nimport { Sorter, combineFilters, getTimestampFromObjectId } from \"../../utils\";\r\n\r\nexport type HeroFilter = (item: IHeroFilterable) => boolean;\r\n\r\nexport interface IHeroFilterable {\r\n  rarity: HeroRarity;\r\n  star: number;\r\n  nick_name?: string;\r\n  hero_id: number;\r\n}\r\n\r\nexport interface IHeroSortable {\r\n  level: number;\r\n  star: number;\r\n  rarity: HeroRarity;\r\n  born: number;\r\n}\r\n\r\nexport interface IHeroListOptions {\r\n  fold: boolean;\r\n  rarity: RarityOption;\r\n  star: number;\r\n  term: string;\r\n}\r\n\r\nexport interface IState {\r\n  listOptions: IHeroListOptions | null;\r\n}\r\n\r\nconst initialState: IState = {\r\n  listOptions: null\r\n};\r\n\r\nexport type RarityOption = \"*\" | HeroRarity | \"M\";\r\n\r\nexport enum ActionType {\r\n  SetListOptions = \"Hero.SetListOptions\"\r\n}\r\n\r\nexport const HeroActions = {\r\n  setListOptions(opts: IHeroListOptions) {\r\n    return {\r\n      type: ActionType.SetListOptions,\r\n      payload: opts\r\n    };\r\n  }\r\n};\r\n\r\nconst materialRarityFilter = (hero: { hero_id: number }) =>\r\n  [410, 411, 412, 413].includes(hero.hero_id);\r\n\r\nexport function reducer(state = initialState, action: IAction<ActionType>) {\r\n  const { type, payload } = action;\r\n  switch (type) {\r\n    case ActionType.SetListOptions: {\r\n      return {\r\n        ...state,\r\n        listOptions: payload\r\n      };\r\n    }\r\n  }\r\n  return state;\r\n}\r\n\r\nconst selectAll = (state: IYyxState) =>\r\n  state.snapshot.current &&\r\n  state.snapshot.current.data.heroes.map(hero => {\r\n    hero.data = getHeroData(hero.hero_id);\r\n    hero.timestamp_from_id = getTimestampFromObjectId(hero.id);\r\n    return hero;\r\n  });\r\n\r\nconst selectMapById = createSelector(\r\n  selectAll,\r\n  heroes => {\r\n    if (!heroes) {\r\n      return null;\r\n    }\r\n    const groups = heroes.reduce((m, i) => {\r\n      m.set(i.id, i);\r\n      return m;\r\n    }, new Map<string, IHero>());\r\n    return groups;\r\n  }\r\n);\r\n\r\nconst selectAllSorted = createSelector(\r\n  selectAll,\r\n  heroes => {\r\n    if (!heroes) {\r\n      return null;\r\n    }\r\n    return heroes.slice().sort(defaultSorter);\r\n  }\r\n);\r\n\r\nconst selectMapByHeroId = createSelector(\r\n  selectAllSorted,\r\n  heroes => {\r\n    if (!heroes) {\r\n      return null;\r\n    }\r\n    const groups = heroes.reduce((m, i) => {\r\n      let list = m.get(i.hero_id);\r\n      if (!list) {\r\n        list = [];\r\n        m.set(i.hero_id, list);\r\n      }\r\n      list.push(i);\r\n      return m;\r\n    }, new Map<number, IHero[]>());\r\n    return groups;\r\n  }\r\n);\r\n\r\nexport interface IHeroFolded {\r\n  hero_id: number;\r\n  level: number;\r\n  awake: number;\r\n  star: number;\r\n  rarity: HeroRarity;\r\n  heroes: IHero[];\r\n  data: IHeroData;\r\n}\r\n\r\nconst FORCE_FOLD_HERO_IDS = [\r\n  205, // 座敷童子\r\n  232, // 铁鼠\r\n  237 // 山兔\r\n];\r\n\r\nconst selectAllFolded = createSelector(\r\n  selectAllSorted,\r\n  heroes => {\r\n    if (!heroes) {\r\n      return null;\r\n    }\r\n\r\n    const skipped: IHero[] = [];\r\n\r\n    let groups = heroes.reduce((m, i) => {\r\n      if (\r\n        !FORCE_FOLD_HERO_IDS.includes(i.hero_id) &&\r\n        (i.awake ||\r\n          RarityRank[i.rarity] > RarityRank[HeroRarity.SR] ||\r\n          i.lock ||\r\n          i.nick_name)\r\n      ) {\r\n        skipped.push(i);\r\n        return m;\r\n      }\r\n\r\n      let group = m.get(i.hero_id);\r\n      if (!group) {\r\n        group = [];\r\n        m.set(i.hero_id, group);\r\n      }\r\n      const item = group.find(\r\n        gi => gi.level === i.level && gi.awake === i.awake && gi.star === i.star\r\n      );\r\n      if (item) {\r\n        item.heroes.push(i);\r\n      } else {\r\n        group.push({\r\n          hero_id: i.hero_id,\r\n          level: i.level,\r\n          awake: i.awake,\r\n          star: i.star,\r\n          rarity: i.rarity,\r\n          heroes: [i],\r\n          data: i.data\r\n        } as IHeroFolded);\r\n      }\r\n      return m;\r\n    }, new Map<number, IHeroFolded[]>());\r\n    const folded = [];\r\n    for (let v of groups.values()) {\r\n      for (let vi of v) {\r\n        if (vi.heroes.length === 1) {\r\n          skipped.push(vi.heroes[0]);\r\n        } else {\r\n          folded.push(vi);\r\n        }\r\n      }\r\n    }\r\n    return [...skipped, ...folded];\r\n  }\r\n);\r\n\r\nconst selectState = (state: IYyxState) => state.hero;\r\nconst selectListOptions = createSelector(\r\n  selectState,\r\n  state => state.listOptions\r\n);\r\n\r\nconst createTermFilter = (term: string) => {\r\n  const v = term.trim();\r\n  const heroIds = DATA.filter((i: IHeroData) => i.name.includes(v)).map(\r\n    (i: IHeroData) => i.id\r\n  );\r\n  return (i: IHeroFilterable) => {\r\n    return (\r\n      heroIds.includes(i.hero_id) ||\r\n      (i.nick_name ? i.nick_name.includes(v) : false)\r\n    );\r\n  };\r\n};\r\n\r\nconst createStarFilter = (v: number) => {\r\n  return (i: IHeroFilterable) => {\r\n    return i.star === v;\r\n  };\r\n};\r\n\r\nconst createRarityFilter = (r: RarityOption) => {\r\n  if (r === \"M\") {\r\n    return materialRarityFilter;\r\n  }\r\n  return (i: IHeroFilterable) => {\r\n    return i.rarity === r;\r\n  };\r\n};\r\n\r\nconst selectList = createSelector(\r\n  selectAllSorted,\r\n  selectAllFolded,\r\n  selectListOptions,\r\n  (sorted, folded, opts) => {\r\n    if (!opts) {\r\n      return null;\r\n    }\r\n\r\n    const filters = [\r\n      opts.term && createTermFilter(opts.term),\r\n      opts.rarity === \"*\" ? null : createRarityFilter(opts.rarity),\r\n      opts.star && createStarFilter(opts.star)\r\n    ].filter(v => !!v) as HeroFilter[];\r\n    const filter = filters.length && combineFilters(...filters);\r\n    if (opts.fold) {\r\n      if (!folded) {\r\n        return null;\r\n      }\r\n      return filter ? folded.filter(filter) : folded;\r\n    } else {\r\n      if (!sorted) {\r\n        return null;\r\n      }\r\n      return filter ? sorted.filter(filter) : sorted;\r\n    }\r\n  }\r\n);\r\n\r\nconst selectCount = createSelector(\r\n  selectList,\r\n  list => {\r\n    if (!list) {\r\n      return 0;\r\n    }\r\n    return list\r\n      .map(i => {\r\n        if (\"heroes\" in i) {\r\n          return i.heroes.length;\r\n        } else {\r\n          return 1;\r\n        }\r\n      })\r\n      .reduce((l, r) => l + r, 0);\r\n  }\r\n);\r\n\r\nexport const HeroSelectors = {\r\n  selectAll,\r\n  selectAllSorted,\r\n  selectAllFolded,\r\n  selectMapById,\r\n  selectMapByHeroId,\r\n  selectListOptions,\r\n  selectList,\r\n  selectCount\r\n};\r\n","import { IHero, HeroRarity } from \"../../interfaces\";\r\nimport { combineSorters, sortDesc } from \"../../utils\";\r\nimport { RarityRank } from \"./data\";\r\n\r\nexport const sortByRarity = (a: IHero, b: IHero) =>\r\n  RarityRank[b.rarity] - RarityRank[a.rarity];\r\nexport const sortByHeroId = (a: IHero, b: IHero) => a.hero_id - b.hero_id;\r\nexport const sortByLevel = (a: IHero, b: IHero) => a.level - b.level;\r\nexport const sortByStar = (a: IHero, b: IHero) => a.star - b.star;\r\nexport const sortByAwake = (a: IHero, b: IHero) => a.awake - b.awake;\r\nexport const defaultSorter = combineSorters(\r\n  sortDesc(sortByStar),\r\n  sortByRarity,\r\n  sortDesc(sortByAwake),\r\n  sortDesc(sortByLevel),\r\n  sortDesc(sortByHeroId)\r\n);\r\n","import { combineSorters, sortDesc } from \"../../utils\";\r\nimport { IHeroEquip } from \"../../interfaces\";\r\n\r\nexport const sortByQuality = (a: IHeroEquip, b: IHeroEquip) =>\r\n  a.quality - b.quality;\r\nexport const sortByLevel = (a: IHeroEquip, b: IHeroEquip) => a.level - b.level;\r\nexport const sortBySuit = (a: IHeroEquip, b: IHeroEquip) =>\r\n  a.suit_id - b.suit_id;\r\n\r\nexport const defaultSorter = combineSorters(\r\n  sortDesc(sortByQuality),\r\n  sortDesc(sortByLevel),\r\n  sortBySuit\r\n);\r\n","import { IHeroEquipSuitData } from \"../../interfaces\";\r\n\r\nconst DATA = require(\"./EQUIP_SUIT_DATA.json\");\r\n\r\nexport const ALL_SUIT_DATA: IHeroEquipSuitData[] = DATA;\r\n\r\nconst DataMap: Map<number, IHeroEquipSuitData> = ALL_SUIT_DATA.reduce(\r\n  (m: Map<number, IHeroEquipSuitData>, i: any) => {\r\n    m.set(i.id, i);\r\n    return m;\r\n  },\r\n  new Map()\r\n);\r\n\r\nexport const getEquipSuiteData = (id: number) => DataMap.get(id);\r\n","import {\r\n  HeroEquipAttrType,\r\n  IHeroEquipSuitData,\r\n  IHeroEquip\r\n} from \"../../interfaces\";\r\nimport { formatAttrValue, AttrValueType } from \"../../utils\";\r\n\r\nconst AttrNames = {\r\n  [HeroEquipAttrType.Hp]: \"生命\",\r\n  [HeroEquipAttrType.Defense]: \"防御\",\r\n  [HeroEquipAttrType.Attack]: \"攻击\",\r\n  [HeroEquipAttrType.HpRate]: \"生命加成\",\r\n  [HeroEquipAttrType.DefenseRate]: \"防御加成\",\r\n  [HeroEquipAttrType.AttackRate]: \"攻击加成\",\r\n  [HeroEquipAttrType.Speed]: \"速度\",\r\n  [HeroEquipAttrType.CritRate]: \"暴击\",\r\n  [HeroEquipAttrType.CritPower]: \"暴击伤害\",\r\n  [HeroEquipAttrType.EffectHitRate]: \"效果命中\",\r\n  [HeroEquipAttrType.EffectResistRate]: \"效果抵抗\"\r\n};\r\n\r\nconst PercentageAttrs = [\r\n  HeroEquipAttrType.HpRate,\r\n  HeroEquipAttrType.DefenseRate,\r\n  HeroEquipAttrType.AttackRate,\r\n  HeroEquipAttrType.CritRate,\r\n  HeroEquipAttrType.CritPower,\r\n  HeroEquipAttrType.EffectHitRate,\r\n  HeroEquipAttrType.EffectResistRate\r\n];\r\n\r\nexport const HeroEquipPosAttrBaseTypes = new Map<number, HeroEquipAttrType[]>([\r\n  [1, [HeroEquipAttrType.Attack]],\r\n  [\r\n    2,\r\n    [\r\n      HeroEquipAttrType.AttackRate,\r\n      HeroEquipAttrType.DefenseRate,\r\n      HeroEquipAttrType.HpRate,\r\n      HeroEquipAttrType.Speed\r\n    ]\r\n  ],\r\n  [3, [HeroEquipAttrType.Defense]],\r\n  [\r\n    4,\r\n    [\r\n      HeroEquipAttrType.AttackRate,\r\n      HeroEquipAttrType.DefenseRate,\r\n      HeroEquipAttrType.HpRate,\r\n      HeroEquipAttrType.EffectHitRate,\r\n      HeroEquipAttrType.EffectResistRate\r\n    ]\r\n  ],\r\n  [5, [HeroEquipAttrType.Hp]],\r\n  [\r\n    6,\r\n    [\r\n      HeroEquipAttrType.AttackRate,\r\n      HeroEquipAttrType.DefenseRate,\r\n      HeroEquipAttrType.HpRate,\r\n      HeroEquipAttrType.CritRate,\r\n      HeroEquipAttrType.CritPower\r\n    ]\r\n  ]\r\n]);\r\n\r\nexport const formatEquipAttrValue = (\r\n  type: HeroEquipAttrType,\r\n  value: number,\r\n  plus?: boolean\r\n) => {\r\n  return (\r\n    (plus && value ? \"+\" : \"\") +\r\n    formatAttrValue(\r\n      value,\r\n      PercentageAttrs.includes(type)\r\n        ? AttrValueType.Percentage\r\n        : AttrValueType.Float\r\n    )\r\n  );\r\n};\r\n\r\nexport const formatEquipAttr = (type: HeroEquipAttrType, value: number) => {\r\n  return [\r\n    AttrNames[type],\r\n    formatAttrValue(\r\n      value,\r\n      PercentageAttrs.includes(type)\r\n        ? AttrValueType.Percentage\r\n        : AttrValueType.Float\r\n    )\r\n  ];\r\n};\r\n\r\nexport const getEquipAttrName = (type: HeroEquipAttrType) => AttrNames[type];\r\n\r\nexport const getEquipSuitAttrName = (suit: IHeroEquipSuitData) => {\r\n  const attr2 = suit.attr[1].length && suit.attr[1][0];\r\n  return attr2 ? getEquipAttrName(attr2.type) : \"单件属性\";\r\n};\r\n\r\nexport const getEquipRandomAttrValue = (\r\n  equip: IHeroEquip,\r\n  type: HeroEquipAttrType\r\n) => {\r\n  if (!equip.random_attr_map) {\r\n    equip.random_attr_map = new Map(equip.random_attrs.map(attr => [\r\n      attr.type,\r\n      attr.value\r\n    ]) as [HeroEquipAttrType, number][]);\r\n  }\r\n  return equip.random_attr_map.get(type) || null;\r\n};\r\n","import { HeroEquipAttrType, IHeroEquip } from \"../../interfaces\";\r\nimport { getEquipRandomAttrValue } from \"./attr\";\r\n\r\n// http://nga.178.com/read.php?tid=15853326\r\n\r\nexport interface IScoreData {\r\n  score: number;\r\n  attrs: [HeroEquipAttrType, number][];\r\n}\r\n\r\nconst round0 = (v: number) => Math.round(v);\r\nconst round2 = (v: number) => Math.round(v * 100) / 100;\r\n\r\nconst AttrValueRounders: Map<\r\n  HeroEquipAttrType,\r\n  (v: number) => number\r\n> = new Map([\r\n  [HeroEquipAttrType.Speed, round0],\r\n  [HeroEquipAttrType.AttackRate, round2],\r\n  [HeroEquipAttrType.CritRate, round2],\r\n  [HeroEquipAttrType.CritPower, round2],\r\n  [HeroEquipAttrType.EffectHitRate, round2],\r\n  [HeroEquipAttrType.EffectResistRate, round2]\r\n]);\r\n\r\nconst SCORE_DATA: IScoreData[] = [];\r\n\r\nconst match = (equip: IHeroEquip, data: IScoreData) => {\r\n  if (equip.random_attrs.length < data.attrs.length) {\r\n    return false;\r\n  }\r\n\r\n  for (let [reqType, reqValue] of data.attrs) {\r\n    const round = AttrValueRounders.get(reqType);\r\n    let value = getEquipRandomAttrValue(equip, reqType);\r\n    if (!value) {\r\n      return false;\r\n    }\r\n    if (round) {\r\n      value = round(value);\r\n    }\r\n    if (value < reqValue) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\n/*\r\n为了给大家更直观理解3分、5分御魂的概念，做了一些举例，其中(1~3)代表着后续说的是3个御魂，为了简便起见，合并成一行展示，御魂之间用分号“；”隔开了。。(7)、(8)这些就是指的单个御魂：\r\n*/\r\n\r\n/*\r\n3分御魂：\r\n*/\r\n\r\n// (1~3)速度+8；暴击+8；攻击加成+8\r\n\r\nSCORE_DATA.push({\r\n  score: 3,\r\n  attrs: [[HeroEquipAttrType.Speed, 8]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 3,\r\n  attrs: [[HeroEquipAttrType.CritRate, 0.08]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 3,\r\n  attrs: [[HeroEquipAttrType.AttackRate, 0.08]]\r\n});\r\n\r\n// (4~6)暴击伤害+11；效果命中+11；效果抵抗+11\r\n\r\nSCORE_DATA.push({\r\n  score: 3,\r\n  attrs: [[HeroEquipAttrType.CritPower, 0.11]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 3,\r\n  attrs: [[HeroEquipAttrType.EffectHitRate, 0.11]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 3,\r\n  attrs: [[HeroEquipAttrType.EffectResistRate, 0.11]]\r\n});\r\n\r\n// (7)速度+3 & 暴击+3 & 暴击伤害+4\r\n\r\nSCORE_DATA.push({\r\n  score: 3,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 3],\r\n    [HeroEquipAttrType.CritRate, 0.03],\r\n    [HeroEquipAttrType.CritPower, 0.04]\r\n  ]\r\n});\r\n\r\n// (8)速度+3 & 暴击+6\r\n\r\nSCORE_DATA.push({\r\n  score: 3,\r\n  attrs: [[HeroEquipAttrType.Speed, 3], [HeroEquipAttrType.CritRate, 0.06]]\r\n});\r\n\r\n/*\r\n4分御魂\r\n*/\r\n\r\n// (1~3)速度+11；暴击+11；攻击加成+11；\r\nSCORE_DATA.push({\r\n  score: 4,\r\n  attrs: [[HeroEquipAttrType.Speed, 11]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 4,\r\n  attrs: [[HeroEquipAttrType.CritRate, 0.11]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 4,\r\n  attrs: [[HeroEquipAttrType.AttackRate, 0.11]]\r\n});\r\n\r\n// (4~6)暴击伤害+14；效果命中+14；效果抵抗+14；\r\nSCORE_DATA.push({\r\n  score: 4,\r\n  attrs: [[HeroEquipAttrType.CritPower, 0.14]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 4,\r\n  attrs: [[HeroEquipAttrType.EffectHitRate, 0.14]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 4,\r\n  attrs: [[HeroEquipAttrType.EffectResistRate, 0.14]]\r\n});\r\n\r\n// (7)速度+3 & 暴击+3 & 暴击伤害+7\r\nSCORE_DATA.push({\r\n  score: 4,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 3],\r\n    [HeroEquipAttrType.CritRate, 0.03],\r\n    [HeroEquipAttrType.CritPower, 0.07]\r\n  ]\r\n});\r\n\r\n// (8)攻击加成+3 & 速度+3 & 暴击伤害+7\r\nSCORE_DATA.push({\r\n  score: 4,\r\n  attrs: [\r\n    [HeroEquipAttrType.AttackRate, 0.03],\r\n    [HeroEquipAttrType.Speed, 3],\r\n    [HeroEquipAttrType.CritPower, 0.07]\r\n  ]\r\n});\r\n\r\n/*\r\n5分御魂：\r\n*/\r\n\r\n// (1~3)速度+13；暴击+13；攻击加成+13； (相信对于绝大多数人而言，这样的御魂已经算是“好御魂”了)\r\nSCORE_DATA.push({\r\n  score: 5,\r\n  attrs: [[HeroEquipAttrType.Speed, 13]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 5,\r\n  attrs: [[HeroEquipAttrType.CritRate, 0.13]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 5,\r\n  attrs: [[HeroEquipAttrType.AttackRate, 0.13]]\r\n});\r\n\r\n// (4~6)暴击伤害+18；效果命中+18；效果抵抗+18；\r\n\r\nSCORE_DATA.push({\r\n  score: 5,\r\n  attrs: [[HeroEquipAttrType.CritPower, 0.18]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 5,\r\n  attrs: [[HeroEquipAttrType.EffectHitRate, 0.18]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 5,\r\n  attrs: [[HeroEquipAttrType.EffectResistRate, 0.18]]\r\n});\r\n\r\n// (7)速度+8 & 效果命中+4 & 效果抵抗+4\r\n\r\nSCORE_DATA.push({\r\n  score: 5,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 8],\r\n    [HeroEquipAttrType.EffectHitRate, 0.04],\r\n    [HeroEquipAttrType.EffectResistRate, 0.04]\r\n  ]\r\n});\r\n\r\n// (8)速度+3 & 效果命中+7 & 效果抵抗+7 (这个御魂，可能在人心目中就是“平平无奇”)\r\n\r\nSCORE_DATA.push({\r\n  score: 5,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 3],\r\n    [HeroEquipAttrType.EffectHitRate, 0.07],\r\n    [HeroEquipAttrType.EffectResistRate, 0.07]\r\n  ]\r\n});\r\n\r\n/*\r\n6分御魂\r\n*/\r\n\r\n// (1~3)速度+16；暴击+16；攻击加成+16 (准“极品”御魂，速度类顶级御魂)\r\n\r\nSCORE_DATA.push({\r\n  score: 6,\r\n  attrs: [[HeroEquipAttrType.Speed, 16]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 6,\r\n  attrs: [[HeroEquipAttrType.CritRate, 0.16]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 6,\r\n  attrs: [[HeroEquipAttrType.AttackRate, 0.16]]\r\n});\r\n\r\n// (4~6)暴击伤害+22；效果命中+22；效果抵抗+22\r\nSCORE_DATA.push({\r\n  score: 6,\r\n  attrs: [[HeroEquipAttrType.CritPower, 0.22]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 6,\r\n  attrs: [[HeroEquipAttrType.EffectHitRate, 0.22]]\r\n});\r\n\r\nSCORE_DATA.push({\r\n  score: 6,\r\n  attrs: [[HeroEquipAttrType.EffectResistRate, 0.22]]\r\n});\r\n\r\n// (7)速度+8 & 效果命中+7 & 效果抵抗4\r\nSCORE_DATA.push({\r\n  score: 6,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 8],\r\n    [HeroEquipAttrType.EffectHitRate, 0.07],\r\n    [HeroEquipAttrType.EffectResistRate, 0.04]\r\n  ]\r\n});\r\n\r\n// (8)速度+3 & 效果命中+7 & 效果抵抗+11\r\n\r\nSCORE_DATA.push({\r\n  score: 6,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 3],\r\n    [HeroEquipAttrType.EffectHitRate, 0.07],\r\n    [HeroEquipAttrType.EffectResistRate, 0.11]\r\n  ]\r\n});\r\n\r\n/*\r\n7分御魂\r\n*/\r\n\r\n// (1)速度+16 & 暴击+3\r\n\r\nSCORE_DATA.push({\r\n  score: 7,\r\n  attrs: [[HeroEquipAttrType.Speed, 16], [HeroEquipAttrType.CritRate, 0.03]]\r\n});\r\n\r\n// (2)速度+3 & 效果命中+22 (纯命中类顶级御魂)\r\n\r\nSCORE_DATA.push({\r\n  score: 7,\r\n  attrs: [[HeroEquipAttrType.Speed, 3], [HeroEquipAttrType.EffectHitRate, 0.22]]\r\n});\r\n\r\n// (3)速度+3 & 攻击加成+11 & 暴击+5\r\n\r\nSCORE_DATA.push({\r\n  score: 7,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 3],\r\n    [HeroEquipAttrType.AttackRate, 0.11],\r\n    [HeroEquipAttrType.CritRate, 0.05]\r\n  ]\r\n});\r\n\r\n// (4)速度+3 & 效果命中+11 & 效果抵抗+11\r\n\r\nSCORE_DATA.push({\r\n  score: 7,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 3],\r\n    [HeroEquipAttrType.EffectHitRate, 0.11],\r\n    [HeroEquipAttrType.EffectResistRate, 0.11]\r\n  ]\r\n});\r\n\r\n/*\r\n8分御魂\r\n*/\r\n\r\n// (1)速度+16 & 暴击+3 & 攻击加成+3\r\n\r\nSCORE_DATA.push({\r\n  score: 8,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 16],\r\n    [HeroEquipAttrType.CritRate, 0.03],\r\n    [HeroEquipAttrType.AttackRate, 0.03]\r\n  ]\r\n});\r\n\r\n// (2)速度+8 & 效果命中+7 & 效果抵抗+11 (双堆类顶级御魂1)\r\n\r\nSCORE_DATA.push({\r\n  score: 8,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 8],\r\n    [HeroEquipAttrType.EffectHitRate, 0.07],\r\n    [HeroEquipAttrType.EffectResistRate, 0.11]\r\n  ]\r\n});\r\n\r\n// (3)速度+3 & 效果命中+11 & 效果抵抗+14 (双堆类顶级御魂2)\r\n\r\nSCORE_DATA.push({\r\n  score: 8,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 3],\r\n    [HeroEquipAttrType.EffectHitRate, 0.11],\r\n    [HeroEquipAttrType.EffectResistRate, 0.14]\r\n  ]\r\n});\r\n\r\n// (4)速度+3 & 暴击+11 & 暴击伤害+11\r\n\r\nSCORE_DATA.push({\r\n  score: 8,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 3],\r\n    [HeroEquipAttrType.CritRate, 0.11],\r\n    [HeroEquipAttrType.CritPower, 0.11]\r\n  ]\r\n});\r\n\r\n/*\r\n9分御魂\r\n\r\n(3)速度+8 & 暴击+3 & 攻击加成+8 & 暴击伤害+11 (输出类满分御魂)\r\n*/\r\n\r\nSCORE_DATA.push({\r\n  score: 9,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 3],\r\n    [HeroEquipAttrType.CritRate, 0.16],\r\n    [HeroEquipAttrType.AttackRate, 0.03],\r\n    [HeroEquipAttrType.CritPower, 0.04]\r\n  ]\r\n});\r\n\r\n// (2)速度+3 & 暴击+11 & 攻击加成+3 & 暴击伤害+11(输出类顶级御魂2)\r\n\r\nSCORE_DATA.push({\r\n  score: 9,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 3],\r\n    [HeroEquipAttrType.CritRate, 0.11],\r\n    [HeroEquipAttrType.AttackRate, 0.03],\r\n    [HeroEquipAttrType.CritPower, 0.11]\r\n  ]\r\n});\r\n\r\n// (2)速度+3 & 暴击+8 & 攻击加成+3 & 暴击伤害+14(输出类顶级御魂3)\r\n\r\nSCORE_DATA.push({\r\n  score: 9,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 3],\r\n    [HeroEquipAttrType.CritRate, 0.08],\r\n    [HeroEquipAttrType.AttackRate, 0.03],\r\n    [HeroEquipAttrType.CritPower, 0.14]\r\n  ]\r\n});\r\n\r\n// (1)速度+3 & 暴击+16 & 攻击加成+3 & 暴击伤害+4 (输出类顶级御魂1)\r\n\r\nSCORE_DATA.push({\r\n  score: 9,\r\n  attrs: [\r\n    [HeroEquipAttrType.Speed, 3],\r\n    [HeroEquipAttrType.CritRate, 0.16],\r\n    [HeroEquipAttrType.AttackRate, 0.03],\r\n    [HeroEquipAttrType.CritPower, 0.04]\r\n  ]\r\n});\r\n\r\nSCORE_DATA.sort((a, b) => b.score - a.score);\r\n\r\nexport function getEquipScoreData(equip: IHeroEquip): IScoreData | null {\r\n  for (let item of SCORE_DATA) {\r\n    if (match(equip, item)) {\r\n      return item;\r\n    }\r\n  }\r\n  return null;\r\n}\r\n","import { IAction, IDispatch, IYyxState } from \"../../store\";\r\nimport { createSelector } from \"reselect\";\r\nimport {\r\n  IHeroEquip,\r\n  HeroEquipAttrType,\r\n  IHeroEquipPreset,\r\n  IHero,\r\n  IHeroEquipSuitData\r\n} from \"../../interfaces\";\r\nimport { defaultSorter } from \"./sorters\";\r\nimport { getEquipSuiteData } from \"./data\";\r\nimport { HeroSelectors } from \"../hero\";\r\nimport { SnapshotSelectors } from \"../snapshot\";\r\nimport { getTimestampFromObjectId, Filter, combineFilters } from \"../../utils\";\r\nimport { getEquipScoreData } from \"./score\";\r\n\r\nexport interface IState {\r\n  listOptions: IEquipListOptions | null;\r\n}\r\n\r\nconst initialState: IState = {\r\n  listOptions: null\r\n};\r\n\r\nexport enum ActionType {\r\n  SetListOptions = \"Equip.etListOptions\"\r\n}\r\n\r\nexport const EquipActions = {\r\n  setListOptions(opts: IEquipListOptions) {\r\n    return {\r\n      type: ActionType.SetListOptions,\r\n      payload: opts\r\n    };\r\n  }\r\n};\r\n\r\nexport function reducer(state = initialState, action: IAction<ActionType>) {\r\n  const { type, payload } = action;\r\n  switch (type) {\r\n    case ActionType.SetListOptions: {\r\n      return {\r\n        ...state,\r\n        listOptions: payload\r\n      };\r\n    }\r\n  }\r\n  return state;\r\n}\r\n\r\nconst selectEquippedByMap = createSelector(\r\n  HeroSelectors.selectAll,\r\n  heroes => {\r\n    const equippedByMap = new Map<string, IHero>();\r\n    if (heroes) {\r\n      for (let h of heroes) {\r\n        for (let id of h.equips) {\r\n          equippedByMap.set(id, h);\r\n        }\r\n      }\r\n    }\r\n    return equippedByMap;\r\n  }\r\n);\r\n\r\nconst selectPresets = createSelector(\r\n  SnapshotSelectors.selectCurrentSnapshot,\r\n  snapshot => {\r\n    if (!snapshot) {\r\n      return null;\r\n    }\r\n    return snapshot.data.hero_equip_presets;\r\n  }\r\n);\r\n\r\nconst selectIncludedInPresetsMap = createSelector(\r\n  selectPresets,\r\n  presets => {\r\n    const map = new Map<string, IHeroEquipPreset[]>();\r\n    if (presets) {\r\n      for (let p of presets) {\r\n        for (let id of p.items) {\r\n          let list = map.get(id);\r\n          if (!list) {\r\n            list = [p];\r\n            map.set(id, list);\r\n          } else {\r\n            list.push(p);\r\n          }\r\n        }\r\n      }\r\n    }\r\n    return map;\r\n  }\r\n);\r\n\r\nconst selectAll = createSelector(\r\n  (state: IYyxState) => state.snapshot.current,\r\n  selectEquippedByMap,\r\n  selectIncludedInPresetsMap,\r\n  (snapshot, equippedBy, inPresets) => {\r\n    if (!snapshot) {\r\n      return null;\r\n    }\r\n    return snapshot.data.hero_equips.map(equip => {\r\n      equip.suit_data = getEquipSuiteData(equip.suit_id);\r\n      equip.equipped_by = equippedBy.get(equip.id);\r\n      equip.included_in_presets = inPresets.get(equip.id);\r\n      equip.timestamp_from_id = getTimestampFromObjectId(equip.id);\r\n      return equip;\r\n    });\r\n  }\r\n);\r\n\r\nconst selectAllSorted = createSelector(\r\n  selectAll,\r\n  equips => {\r\n    if (!equips) {\r\n      return null;\r\n    }\r\n    return equips.slice().sort(defaultSorter);\r\n  }\r\n);\r\n\r\nconst selectMaps = createSelector(\r\n  selectAllSorted,\r\n  equips => {\r\n    if (!equips) {\r\n      return null;\r\n    }\r\n\r\n    const idMap = new Map<string, IHeroEquip>();\r\n    const qualityMap = new Map<number, IHeroEquip[]>();\r\n    const levelMap = new Map<number, IHeroEquip[]>();\r\n    const suitMap = new Map<number, IHeroEquip[]>();\r\n    const posMap = new Map<number, IHeroEquip[]>();\r\n    const baseAttrMap = new Map<HeroEquipAttrType, IHeroEquip[]>();\r\n\r\n    function push<K>(\r\n      map: Map<K, IHeroEquip[]>,\r\n      i: IHeroEquip,\r\n      selector: (i: IHeroEquip) => K\r\n    ) {\r\n      const key = selector(i);\r\n      let list = map.get(key);\r\n      if (!list) {\r\n        list = [i];\r\n        map.set(key, list);\r\n      } else {\r\n        list.push(i);\r\n      }\r\n    }\r\n\r\n    for (let e of equips) {\r\n      idMap.set(e.id, e);\r\n      push(qualityMap, e, e => e.quality);\r\n      push(levelMap, e, e => e.level);\r\n      push(suitMap, e, e => e.suit_id);\r\n      push(posMap, e, e => e.pos);\r\n      push(baseAttrMap, e, e => e.base_attr.type);\r\n    }\r\n\r\n    return {\r\n      id: idMap,\r\n      quality: qualityMap,\r\n      level: levelMap,\r\n      suit: suitMap,\r\n      base_attr: baseAttrMap\r\n    };\r\n  }\r\n);\r\n\r\nexport enum EquipLevelFilter {\r\n  Any,\r\n  Zero,\r\n  Max\r\n}\r\n\r\nexport enum EquipEquippedFilter {\r\n  Any,\r\n  Equipped,\r\n  NotEquipped\r\n}\r\n\r\nexport interface IEquipListOptions {\r\n  id: string;\r\n  types: number[] | null;\r\n  positions: number[];\r\n  stars: number[];\r\n  baseAttrs: HeroEquipAttrType[] | null;\r\n  trashed: boolean | null;\r\n  level: EquipLevelFilter;\r\n  equipped: EquipEquippedFilter;\r\n  creationTimeFrom: Date | null;\r\n  creationTimeTo: Date | null;\r\n  scores: number[];\r\n}\r\n\r\nconst selectDisplay = createSelector(\r\n  selectAllSorted,\r\n  (state: IYyxState) => state.equip.listOptions,\r\n  (equips, opts) => {\r\n    if (!opts) {\r\n      return null;\r\n    }\r\n\r\n    if (!equips) {\r\n      return null;\r\n    }\r\n\r\n    if (opts.id) {\r\n      return equips.filter(e => e.id === opts.id);\r\n    }\r\n\r\n    const filters: Array<Filter<IHeroEquip>> = [];\r\n\r\n    if (opts.types && opts.types.length) {\r\n      filters.push(i => !!(opts.types && opts.types.includes(i.suit_id)));\r\n    }\r\n\r\n    if (opts.positions && opts.positions.length) {\r\n      filters.push(\r\n        i => !!(opts.positions && opts.positions.includes(i.pos + 1))\r\n      );\r\n    }\r\n\r\n    if (opts.stars && opts.stars.length) {\r\n      filters.push(i => !!(opts.stars && opts.stars.includes(i.quality)));\r\n    }\r\n\r\n    if (opts.baseAttrs && opts.baseAttrs.length) {\r\n      filters.push(\r\n        i => !!(opts.baseAttrs && opts.baseAttrs.includes(i.base_attr.type))\r\n      );\r\n    }\r\n\r\n    if (opts.level !== EquipLevelFilter.Any) {\r\n      if (opts.level === EquipLevelFilter.Zero) {\r\n        filters.push(i => i.level === 0);\r\n      } else {\r\n        filters.push(i => i.level === 15);\r\n      }\r\n    }\r\n\r\n    if (opts.equipped !== EquipEquippedFilter.Any) {\r\n      if (opts.equipped === EquipEquippedFilter.Equipped) {\r\n        filters.push(i => !!i.equipped_by);\r\n      } else {\r\n        filters.push(i => !i.equipped_by);\r\n      }\r\n    }\r\n\r\n    if (opts.trashed !== null) {\r\n      filters.push(i => i.garbage === opts.trashed);\r\n    }\r\n\r\n    if (opts.scores.length) {\r\n      filters.push(i => {\r\n        const scoreData = getEquipScoreData(i);\r\n        if (!scoreData) {\r\n          return false;\r\n        } else {\r\n          return opts.scores.includes(scoreData.score);\r\n        }\r\n      });\r\n    }\r\n\r\n    if (opts.creationTimeFrom) {\r\n      const t = opts.creationTimeFrom.getTime() / 1000;\r\n      filters.push(i => getTimestampFromObjectId(i.id) >= t);\r\n    }\r\n\r\n    if (opts.creationTimeTo) {\r\n      const t = opts.creationTimeTo.getTime() / 1000;\r\n      filters.push(i => getTimestampFromObjectId(i.id) < t);\r\n    }\r\n\r\n    if (filters.length) {\r\n      return equips.filter(combineFilters(...filters));\r\n    }\r\n\r\n    return equips;\r\n  }\r\n);\r\n\r\nexport type IEquipPresetItem = IHeroEquipPreset & IEquipSetInfo;\r\n\r\nexport interface IEquipSetInfo {\r\n  equips: IHeroEquip[];\r\n  suits: IHeroEquipSuitData[];\r\n  attrMap: Map<HeroEquipAttrType, number>;\r\n}\r\n\r\nexport const computeEquipSetInfo = (equips: IHeroEquip[]) => {\r\n  const suitCount = new Map<number, number>();\r\n  const attrMap = new Map<HeroEquipAttrType, number>();\r\n  const suits = [];\r\n  suitCount.clear();\r\n  for (const equip of equips) {\r\n    for (const attr of equip.attrs) {\r\n      const v = attrMap.get(attr.type) || 0;\r\n      attrMap.set(attr.type, v + attr.value);\r\n    }\r\n\r\n    {\r\n      const v = attrMap.get(equip.base_attr.type) || 0;\r\n      attrMap.set(equip.base_attr.type, v + equip.base_attr.value);\r\n    }\r\n\r\n    for (let attr of equip.single_attrs) {\r\n      const v = attrMap.get(attr.type) || 0;\r\n      attrMap.set(attr.type, v + attr.value);\r\n    }\r\n\r\n    const c = suitCount.get(equip.suit_id) || 0;\r\n    suitCount.set(equip.suit_id, c + 1);\r\n  }\r\n  for (let [suitId, count] of suitCount.entries()) {\r\n    if (count >= 2) {\r\n      const data = getEquipSuiteData(suitId);\r\n      if (data) {\r\n        if (data.effect[1].length) {\r\n          suits.push(data);\r\n        }\r\n        if (data.attr[1].length) {\r\n          for (let attr of data.attr[1]) {\r\n            const v = attrMap.get(attr.type) || 0;\r\n            attrMap.set(attr.type, v + attr.value);\r\n          }\r\n        }\r\n        if (data.effect[3].length && count >= 4) {\r\n          suits.push(data);\r\n        }\r\n      } else {\r\n        console.warn(`unknown equip suit id: ${suitId}`);\r\n      }\r\n    }\r\n  }\r\n  return {\r\n    suits,\r\n    equips,\r\n    attrMap\r\n  } as IEquipSetInfo;\r\n};\r\n\r\nconst selectPresetItems = createSelector(\r\n  selectPresets,\r\n  selectMaps,\r\n  (presets, maps) => {\r\n    if (!presets || !maps) {\r\n      return null;\r\n    }\r\n    return presets.map(p => {\r\n      const equips = p.items\r\n        .map(id => maps.id.get(id))\r\n        .filter(v => !!v) as IHeroEquip[];\r\n      return {\r\n        ...p,\r\n        ...computeEquipSetInfo(equips)\r\n      } as IEquipPresetItem;\r\n    });\r\n  }\r\n);\r\n\r\nexport const EquipSelectors = {\r\n  selectAllSorted,\r\n  selectMaps,\r\n  selectDisplay,\r\n  selectPresetItems\r\n};\r\n","import React, { SFC } from \"react\";\r\nimport \"./Star.scss\";\r\nimport classNames from \"classnames\";\r\n\r\nexport interface StarProps {\r\n  type: StarType;\r\n}\r\n\r\nexport enum StarType {\r\n  Grey = \"grey\",\r\n  Orange = \"orange\",\r\n  Purple = \"purple\",\r\n  Blue = \"blue\"\r\n}\r\n\r\nconst renderStar = (i: number, type: StarType) => {\r\n  return <i key={i} className={classNames(\"star\", `star-${type}`)} />;\r\n};\r\n\r\nconst Elements: { [key: string]: JSX.Element[][] } = {\r\n  [StarType.Orange]: [],\r\n  [StarType.Purple]: [],\r\n  [StarType.Blue]: []\r\n};\r\nfor (let i = 0; i < 6; i++) {\r\n  const orangeElems = [];\r\n  const purpleElems = [];\r\n  const blueElems = [];\r\n  for (let ii = 0; ii <= i; ii++) {\r\n    orangeElems.push(renderStar(ii, StarType.Orange));\r\n    purpleElems.push(renderStar(ii, StarType.Purple));\r\n    blueElems.push(renderStar(ii, StarType.Blue));\r\n  }\r\n  for (let ii = i + 1; ii < 6; ii++) {\r\n    orangeElems.push(renderStar(ii, StarType.Grey));\r\n    purpleElems.push(renderStar(ii, StarType.Grey));\r\n    blueElems.push(renderStar(ii, StarType.Grey));\r\n  }\r\n  Elements[StarType.Orange].push(orangeElems);\r\n  Elements[StarType.Purple].push(purpleElems);\r\n  Elements[StarType.Blue].push(blueElems);\r\n}\r\n\r\nexport const Stars: SFC<StarProps & { level: number }> = props => {\r\n  return <span className=\"stars\">{Elements[props.type][props.level - 1]}</span>;\r\n};\r\n","import {\r\n  createStore,\r\n  combineReducers,\r\n  applyMiddleware,\r\n  compose,\r\n  Dispatch\r\n} from \"redux\";\r\nimport thunk, { ThunkDispatch, ThunkAction } from \"redux-thunk\";\r\n\r\nimport * as error from \"./modules/error\";\r\nimport * as snapshot from \"./modules/snapshot\";\r\nimport * as hero from \"./modules/hero\";\r\nimport * as equip from \"./modules/equip\";\r\n\r\ntype ActionType =\r\n  | error.ActionType\r\n  | snapshot.ActionType\r\n  | hero.ActionType\r\n  | equip.ActionType;\r\n\r\nexport interface IAction<T = ActionType> {\r\n  type: T;\r\n  payload?: any;\r\n}\r\n\r\nexport type IDispatch<T = ActionType> = ThunkDispatch<\r\n  IYyxState,\r\n  void,\r\n  IAction<T>\r\n>;\r\n\r\nexport interface IYyxState {\r\n  error: error.IState;\r\n  snapshot: snapshot.IState;\r\n  hero: hero.IState;\r\n  equip: equip.IState;\r\n}\r\n\r\nconst composeEnhancers =\r\n  (window as any).__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\nexport const YyxStore = createStore<IYyxState, any, {}, {}>(\r\n  combineReducers({\r\n    error: error.reducer,\r\n    snapshot: snapshot.reducer,\r\n    hero: hero.reducer,\r\n    equip: equip.reducer\r\n  }),\r\n  composeEnhancers(applyMiddleware(thunk))\r\n);\r\n","import { connect } from \"react-redux\";\r\nimport { ReactElement, SFC } from \"react\";\r\nimport { IYyxState } from \"../../store\";\r\nimport { ISnapshot } from \"../../interfaces\";\r\n\r\ninterface RenderProps {\r\n  current: ISnapshot | null;\r\n  notSelected: boolean;\r\n  render: (info: ISnapshot | null) => ReactElement | null;\r\n}\r\n\r\nconst Render: SFC<RenderProps> = (props: RenderProps) => {\r\n  return props.render(props.current);\r\n};\r\n\r\nexport interface SnapshotInfoProps {\r\n  render: (info: ISnapshot | null) => ReactElement | null;\r\n}\r\n\r\nexport const SnapshotInfo = connect(\r\n  (state: IYyxState) => ({\r\n    current: state.snapshot.current,\r\n    notSelected: state.snapshot.currentNotSelected\r\n  }),\r\n  null,\r\n  (stateProps, dispatchProps, ownProps: SnapshotInfoProps) => ({\r\n    ...stateProps,\r\n    render: ownProps.render\r\n  })\r\n)(Render);\r\n","import React, { SFC } from \"react\";\r\nimport \"./OverviewPage.scss\";\r\nimport { SnapshotInfo } from \"../Snapshot/SnapshotInfo\";\r\nimport { Card } from \"@blueprintjs/core\";\r\nimport { ISnapshot } from \"../../interfaces\";\r\nimport { formatDate } from \"../../utils\";\r\n\r\nconst render = (info: ISnapshot | null) => {\r\n  if (!info) {\r\n    return null;\r\n  }\r\n\r\n  const { player, currency, heroes, hero_equips } = info.data;\r\n\r\n  return (\r\n    <table className=\"bp3-html-table bp3-html-table-striped yyx-prop-table\">\r\n      <tbody>\r\n        <tr>\r\n          <td>快照版本</td>\r\n          <td>{info.version}</td>\r\n        </tr>\r\n        <tr>\r\n          <td>快照日期</td>\r\n          <td>{formatDate(info.timestamp)}</td>\r\n        </tr>\r\n        <tr>\r\n          <td>玩家</td>\r\n          <td>\r\n            {player.name} Lv.{player.level}\r\n          </td>\r\n        </tr>\r\n        <tr>\r\n          <td>资产</td>\r\n          <td>\r\n            <ul className=\"bp3-list-unstyled\">\r\n              <li>金币: {currency.coin}</li>\r\n              <li>勾玉: {currency.jade}</li>\r\n              <li>体力: {currency.action_point}</li>\r\n            </ul>\r\n          </td>\r\n        </tr>\r\n        <tr>\r\n          <td>式神数量</td>\r\n          <td>{heroes.length}</td>\r\n        </tr>\r\n        <tr>\r\n          <td>御魂数量</td>\r\n          <td>{hero_equips.length}</td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  );\r\n};\r\n\r\nconst OverviewPage: SFC = props => {\r\n  return <SnapshotInfo render={render} />;\r\n};\r\n\r\nexport { OverviewPage };\r\n","import React, { SFC, MouseEventHandler } from \"react\";\r\nimport \"./SubNav.scss\";\r\nimport classNames from \"classnames\";\r\nimport { Menu, Classes, MenuItem, MenuDivider, Icon } from \"@blueprintjs/core\";\r\nimport { withRouter, RouteComponentProps, Link } from \"react-router-dom\";\r\n\r\nexport interface SubNavLink {\r\n  label: string;\r\n  to: string;\r\n}\r\n\r\nconst Render: SFC<RouteComponentProps & { links: SubNavLink[] }> = props => {\r\n  const path = props.location.pathname;\r\n  return (\r\n    <Menu large className=\"sub-nav\">\r\n      {props.links.map((link, i) => (\r\n        <MenuItem\r\n          key={i}\r\n          active={path === link.to}\r\n          text={link.label}\r\n          href={link.to}\r\n          onClick={(e: React.MouseEvent) => handleLinkClick(e, props, link)}\r\n        />\r\n      ))}\r\n    </Menu>\r\n  );\r\n};\r\n\r\nconst handleLinkClick = (\r\n  e: React.MouseEvent,\r\n  route: RouteComponentProps,\r\n  link: SubNavLink\r\n) => {\r\n  e.preventDefault();\r\n  route.history.push(link.to);\r\n};\r\n\r\nexport const SubNav = withRouter(Render);\r\n","import React, { SFC } from \"react\";\r\nimport \"./HeroIcon.scss\";\r\nimport { IHero, HeroRarity, IHeroData } from \"../../interfaces\";\r\nimport classNames from \"classnames\";\r\nimport { HERO_MAX_LEVEL } from \"../../constants\";\r\nimport { Stars, StarType } from \"../Common/Star\";\r\n\r\nconst getStarType = (h: { rarity: HeroRarity; awake: number }) => {\r\n  if (h.rarity === HeroRarity.N) {\r\n    return StarType.Blue;\r\n  } else if (h.rarity === HeroRarity.SP) {\r\n    return StarType.Purple;\r\n  } else {\r\n    return h.awake > 0 ? StarType.Purple : StarType.Orange;\r\n  }\r\n};\r\n\r\nexport interface IHeroIconItem {\r\n  id?: string;\r\n  hero_id: number;\r\n  level: number;\r\n  star: number;\r\n  rarity: HeroRarity;\r\n  awake: number;\r\n}\r\n\r\nexport const HeroIcon: SFC<{\r\n  hero: IHeroIconItem;\r\n  className?: string;\r\n  onClickHero?: (item: IHeroIconItem) => void;\r\n  childHeros?: IHero[];\r\n}> = props => {\r\n  const h = props.hero;\r\n  return (\r\n    <div\r\n      className={classNames(\r\n        \"hero-icon\",\r\n        `rarity-${h.rarity.toLowerCase()}`,\r\n        !props.childHeros && props.onClickHero && \"clickable\",\r\n        props.className\r\n      )}\r\n      key={h.id}\r\n      onClick={() => props.onClickHero && props.onClickHero(h)}\r\n    >\r\n      <img src={`/res/hero/${h.hero_id}.png`} />\r\n      <div className=\"level\">{h.level === HERO_MAX_LEVEL ? \"满\" : h.level}</div>\r\n      {props.childHeros && (\r\n        <div className=\"children-count\">\r\n          <span>{props.childHeros.length}</span>\r\n        </div>\r\n      )}\r\n      <div className=\"star-level\">\r\n        <Stars type={getStarType(h)} level={h.star} />\r\n      </div>\r\n      {h.awake > 0 && <div className=\"awake\">觉</div>}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const HeroDataIcon: SFC<{\r\n  data: IHeroData;\r\n  className?: string;\r\n}> = props => {\r\n  return (\r\n    <div\r\n      className={classNames(\r\n        \"hero-icon\",\r\n        `rarity-${props.data.rarity.toLowerCase()}`,\r\n        props.className\r\n      )}\r\n      key={props.data.id}\r\n    >\r\n      <img src={`/res/hero/${props.data.id}.png`} />\r\n      <div className=\"name\">{props.data.name}</div>\r\n    </div>\r\n  );\r\n};\r\n","export const HERO_MAX_LEVEL = 40;\r\n","import React, { SFC } from \"react\";\r\nimport \"./HeroGrid.scss\";\r\nimport { HeroIcon, IHeroIconItem } from \"./HeroIcon\";\r\nimport { IHero } from \"../../interfaces\";\r\n\r\nexport interface HeroGridProps {\r\n  items: (IHeroIconItem & { heroes?: IHero[] })[];\r\n  onClickHero: (item: IHeroIconItem) => void;\r\n}\r\n\r\nexport const HeroGrid: SFC<HeroGridProps> = props => {\r\n  return (\r\n    <div className=\"hero-grid\">\r\n      <div className=\"hero-grid-container\">\r\n        {props.items.map((i, idx) =>\r\n          i.heroes ? (\r\n            <HeroIcon\r\n              key={idx}\r\n              className=\"hero-grid-item\"\r\n              hero={i}\r\n              childHeros={i.heroes}\r\n            />\r\n          ) : (\r\n            <HeroIcon\r\n              key={idx}\r\n              className=\"hero-grid-item\"\r\n              hero={i}\r\n              onClickHero={props.onClickHero}\r\n            />\r\n          )\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { SFC } from \"react\";\r\nimport \"./Rarity.scss\";\r\nimport classNames from \"classnames\";\r\nimport { HeroRarity } from \"../../interfaces\";\r\n\r\nconst ClassNames = {\r\n  [HeroRarity.SP]: \"sp\",\r\n  [HeroRarity.SSR]: \"ssr\",\r\n  [HeroRarity.SR]: \"sr\",\r\n  [HeroRarity.R]: \"r\",\r\n  [HeroRarity.N]: \"n\"\r\n};\r\n\r\nexport const Rarity: SFC<{\r\n  rarity: HeroRarity;\r\n  className?: string;\r\n}> = props => {\r\n  return (\r\n    <i\r\n      className={classNames(\r\n        \"rarity\",\r\n        `rarity-${ClassNames[props.rarity]}`,\r\n        props.className\r\n      )}\r\n    />\r\n  );\r\n};\r\n","import React, { SFC } from \"react\";\r\nimport \"./Rating.scss\";\r\nimport classNames from \"classnames\";\r\nimport { Ratings } from \"../../interfaces\";\r\n\r\nexport interface RatingProps {\r\n  rating: Ratings;\r\n  className?: string;\r\n}\r\n\r\nexport const Rating: SFC<RatingProps> = props => {\r\n  return (\r\n    <i\r\n      className={classNames(\r\n        \"rating\",\r\n        `rating-${props.rating}`,\r\n        props.className\r\n      )}\r\n    />\r\n  );\r\n};\r\n","import React, { SFC } from \"react\";\r\nimport \"./EquipIcon.scss\";\r\nimport classNames from \"classnames\";\r\n\r\nexport const EquipIcon: SFC<{\r\n  suit_id: number;\r\n  pos: number;\r\n  className?: string;\r\n}> = props => {\r\n  const { suit_id, pos, className } = props;\r\n  return (\r\n    <div className={classNames(\"hero-equip-icon\", className)}>\r\n      <div className={classNames(\"icon\", `pos-${pos + 1}`)}>\r\n        <EquipTypeIcon id={suit_id} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const EquipTypeIcon: SFC<{\r\n  id: number;\r\n  size?: number;\r\n  className?: string;\r\n}> = ({ id, size = 80, className }) => {\r\n  return (\r\n    <img\r\n      className={className}\r\n      src={`/res/suit/${id}.png`}\r\n      width={size}\r\n      height={size}\r\n    />\r\n  );\r\n};\r\n","import React, { SFC } from \"react\";\r\nimport \"./EquipDetail.scss\";\r\nimport { IHeroEquip, IHero, IHeroEquipPreset } from \"../../interfaces\";\r\nimport { EquipIcon } from \"./EquipIcon\";\r\nimport { Stars, StarType } from \"../Common/Star\";\r\nimport { formatEquipAttr } from \"../../modules/equip/attr\";\r\nimport { formatTimestamp } from \"../../utils\";\r\nimport { getEquipScoreData } from \"../../modules/equip/score\";\r\n\r\nexport const EquipDetail: SFC<{\r\n  equip: IHeroEquip;\r\n  equippedBy?: IHero;\r\n  presets?: IHeroEquipPreset[];\r\n}> = props => {\r\n  const { equip } = props;\r\n  const [baseAttrName, baseAttrValue] = formatEquipAttr(\r\n    equip.base_attr.type,\r\n    equip.base_attr.value\r\n  );\r\n\r\n  const scoreData = getEquipScoreData(equip);\r\n\r\n  return (\r\n    <div className=\"equip-detail\">\r\n      <header className=\"yyx-layout row\">\r\n        <div className=\"item icon\">\r\n          <EquipIcon suit_id={equip.suit_id} pos={equip.pos} />\r\n        </div>\r\n        <div className=\"item title\">\r\n          {equip.suit_data && equip.suit_data.name}\r\n          {equip.level > 0 && (\r\n            <>\r\n              &nbsp;<span>+{equip.level}</span>\r\n            </>\r\n          )}\r\n          <br />\r\n          <Stars type={StarType.Orange} level={equip.quality} />\r\n        </div>\r\n      </header>\r\n      <div className=\"attrs\">\r\n        <div className=\"yyx-layout row base-attr\">\r\n          <div className=\"name\">{baseAttrName}</div>\r\n          <div className=\"value\">+{baseAttrValue}</div>\r\n        </div>\r\n        {equip.random_attrs.map(attr => {\r\n          const [name, value] = formatEquipAttr(attr.type, attr.value);\r\n          return (\r\n            <div key={attr.type} className=\"yyx-layout row\">\r\n              <div className=\"name\">{name}</div>\r\n              <div className=\"value\">{value}</div>\r\n            </div>\r\n          );\r\n        })}\r\n        {equip.single_attrs.length ? (\r\n          <div className=\"single-attrs bp3-text-muted\">\r\n            {equip.single_attrs.map(attr => {\r\n              const [name, value] = formatEquipAttr(attr.type, attr.value);\r\n              return (\r\n                <div key={name} className=\"yyx-layout row\">\r\n                  <div className=\"name\">固有属性</div>\r\n                  <div className=\"value\">\r\n                    {name} {value}\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        ) : null}\r\n      </div>\r\n      <div className=\"props\">\r\n        <div className=\"yyx-layout row\">\r\n          <div className=\"name\">ID</div>\r\n          <div className=\"value id\">{equip.id}</div>\r\n        </div>\r\n        <div className=\"yyx-layout row\">\r\n          <a\r\n            href=\"http://nga.178.com/read.php?tid=15853326\"\r\n            target=\"_blank\"\r\n            className=\"name\"\r\n          >\r\n            副属性评分\r\n          </a>\r\n          <div className=\"value\">{scoreData ? scoreData.score : \"无\"}</div>\r\n        </div>\r\n        <div className=\"yyx-layout row\">\r\n          <div className=\"name\">获取时间</div>\r\n          <div className=\"value\">\r\n            {formatTimestamp(equip.timestamp_from_id)}\r\n          </div>\r\n        </div>\r\n        {equip.equipped_by && (\r\n          <div className=\"yyx-layout row\">\r\n            <div className=\"name\">装备式神</div>\r\n            <div className=\"value\">\r\n              {equip.equipped_by.nick_name ||\r\n                (equip.equipped_by.data && equip.equipped_by.data.name)}\r\n            </div>\r\n          </div>\r\n        )}\r\n        {equip.included_in_presets && (\r\n          <div className=\"yyx-layout row\">\r\n            <div className=\"name\">所属方案</div>\r\n            <div className=\"value\">\r\n              <ul className=\"preset-list\">\r\n                {equip.included_in_presets.map((p, i) => (\r\n                  <li key={i}>{p.name}</li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { SFC, useState } from \"react\";\r\nimport \"./EquipItem.scss\";\r\nimport { IHeroEquip } from \"../../interfaces\";\r\nimport classNames from \"classnames\";\r\nimport { Stars, StarType } from \"../Common/Star\";\r\nimport { Popover, Classes } from \"@blueprintjs/core\";\r\nimport { EquipDetail } from \"./EquipDetail\";\r\n\r\nexport const EquipItem: SFC<{\r\n  equip: IHeroEquip;\r\n  className?: string;\r\n  minimal?: boolean;\r\n  onClickEquip?: (equip: IHeroEquip) => void;\r\n}> = props => {\r\n  const { equip, className } = props;\r\n  return (\r\n    <Popover\r\n      content={<EquipDetail equip={equip} />}\r\n      minimal\r\n      popoverClassName={classNames(Classes.POPOVER_CONTENT_SIZING)}\r\n      portalClassName=\"hero-equip-item-popover\"\r\n    >\r\n      <div\r\n        className={classNames(\r\n          \"hero-equip-item\",\r\n          props.onClickEquip && \"clickable\",\r\n          equip.garbage && \"trashed\",\r\n          props.minimal && \"minimal\",\r\n          className\r\n        )}\r\n        onClick={() => props.onClickEquip && props.onClickEquip(equip)}\r\n      >\r\n        {equip.level > 0 && <label>+{equip.level}</label>}\r\n        {equip.equipped_by && <div className=\"equipped\">装备</div>}\r\n        <div className=\"stars\">\r\n          <Stars type={StarType.Orange} level={equip.quality} />\r\n        </div>\r\n        <div className={classNames(\"icon\", `pos-${equip.pos + 1}`)}>\r\n          <img src={`/res/suit/${equip.suit_id}.png`} />\r\n        </div>\r\n      </div>\r\n    </Popover>\r\n  );\r\n};\r\n","import React, { SFC, useState, useEffect } from \"react\";\r\nimport classNames from \"classnames\";\r\nimport \"./EquipSet.scss\";\r\nimport { IHeroEquip } from \"../../interfaces\";\r\nimport { EquipItem } from \"./EquipItem\";\r\nimport { Popover, Classes, PopperModifiers } from \"@blueprintjs/core\";\r\nimport { EquipDetail } from \"./EquipDetail\";\r\n\r\nexport const EquipSet: SFC<{\r\n  className?: string;\r\n  equips: IHeroEquip[];\r\n}> = props => {\r\n  const [items, setItems] = useState<(IHeroEquip | null)[]>([]);\r\n\r\n  useEffect(() => {\r\n    const list = new Array(6).fill(null);\r\n    for (let equip of equips) {\r\n      list[equip.pos] = equip;\r\n    }\r\n    setItems(list);\r\n  }, [props.equips]);\r\n\r\n  const { equips } = props;\r\n\r\n  return (\r\n    <div className=\"equip-set\">\r\n      {items.map(i => {\r\n        return (\r\n          i && (\r\n            <div key={i.id} className={`equip-set-item pos-${i.pos + 1}`}>\r\n              <EquipItem minimal equip={i} />\r\n            </div>\r\n          )\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n","import { connect } from \"react-redux\";\r\nimport { ReactElement, SFC } from \"react\";\r\nimport { IYyxState } from \"../../store\";\r\nimport { IHeroEquip } from \"../../interfaces\";\r\nimport { EquipSelectors } from \"../../modules/equip\";\r\n\r\ninterface RenderProps {\r\n  equips: IHeroEquip[];\r\n  render: (equips: IHeroEquip[]) => ReactElement | null;\r\n}\r\n\r\nconst Render: SFC<RenderProps> = (props: RenderProps) => {\r\n  return props.render(props.equips);\r\n};\r\n\r\nexport interface EquipsProps {\r\n  ids: string[];\r\n  render: (equips: IHeroEquip[]) => ReactElement | null;\r\n}\r\n\r\nexport const Equips = connect((state: IYyxState, props: EquipsProps) => {\r\n  const maps = EquipSelectors.selectMaps(state);\r\n  return {\r\n    equips:\r\n      maps && maps.id\r\n        ? (props.ids\r\n            .map(id => maps.id.get(id))\r\n            .filter(v => !!v) as IHeroEquip[])\r\n        : [],\r\n    render: props.render\r\n  };\r\n})(Render);\r\n","import React, { SFC } from \"react\";\r\nimport \"./HeroDetail.scss\";\r\nimport {\r\n  IHero,\r\n  IHeroAttrRating,\r\n  IHeroAttrs,\r\n  IHeroAttr\r\n} from \"../../interfaces\";\r\nimport { HeroIcon } from \"./HeroIcon\";\r\nimport { Rarity } from \"../Common/Rarity\";\r\nimport classNames from \"classnames\";\r\nimport { Rating } from \"../Common/Rating\";\r\nimport { AttrValueType, formatAttrValue, formatTimestamp } from \"../../utils\";\r\nimport { Divider } from \"@blueprintjs/core\";\r\nimport { EquipSet } from \"../Equip/EquipSet\";\r\nimport { Equips } from \"../Equip/Equips\";\r\n\r\nconst renderIconName = (hero: IHero) => (\r\n  <div className=\"icon-name yyx-layout row\">\r\n    <div className=\"icon item\">\r\n      <HeroIcon hero={hero} />\r\n    </div>\r\n    <div className=\"name item yyx-layout column\">\r\n      <div className=\"yyx-layout row yyx-space-v\">\r\n        <Rarity rarity={hero.rarity} className=\"item\" />\r\n        <div className=\"item hero\" style={{ flex: \"0 0 auto\" }}>\r\n          {hero.data && hero.data.name}\r\n        </div>\r\n      </div>\r\n      {hero.nick_name && <div>昵称: {hero.nick_name}</div>}\r\n    </div>\r\n  </div>\r\n);\r\n\r\nconst attrs: Array<[string, string, string, AttrValueType]> = [\r\n  [\"attack\", \"攻击\", \"attack\", AttrValueType.Float],\r\n  [\"max_hp\", \"生命\", \"max-hp\", AttrValueType.Float],\r\n  [\"defense\", \"防御\", \"defense\", AttrValueType.Float],\r\n  [\"speed\", \"速度\", \"speed\", AttrValueType.Float],\r\n  [\"crit_rate\", \"暴击\", \"crit-rate\", AttrValueType.Percentage]\r\n];\r\n\r\nconst renderAttrs = (hero: IHero, ratings: IHeroAttrRating) => (\r\n  <div className=\"attrs yyx-layout column\">\r\n    {attrs.map(([key, label, className, type]) => {\r\n      const attr = hero.attrs[key as keyof IHeroAttrs] as IHeroAttr;\r\n      return (\r\n        <div key={key} className=\"yyx-layout row\">\r\n          <i className={classNames(\"attr-icon item yyx-space-h\", className)} />\r\n          <Rating\r\n            className=\"item rating\"\r\n            rating={ratings[key as keyof IHeroAttrRating]}\r\n          />\r\n          <span className=\"item label\">{label}</span>\r\n          <span className=\"item attr-value\">\r\n            {formatAttrValue(attr.base, type)}\r\n            {attr.value > attr.base && (\r\n              <span className=\"plus-value\">\r\n                +{formatAttrValue(attr.value - attr.base, type)}\r\n              </span>\r\n            )}\r\n          </span>\r\n        </div>\r\n      );\r\n    })}\r\n    <div className=\"yyx-layout row\">\r\n      <span className=\"item label\">暴击伤害</span>\r\n      <span className=\"item attr-value\">\r\n        {formatAttrValue(\r\n          1 + hero.attrs.crit_power.value,\r\n          AttrValueType.Percentage\r\n        )}\r\n      </span>\r\n    </div>\r\n    <div className=\"yyx-layout row\">\r\n      <span className=\"item label\">效果命中</span>\r\n      <span className=\"item attr-value\">\r\n        {formatAttrValue(\r\n          1 + hero.attrs.effect_hit_rate - 1,\r\n          AttrValueType.Percentage\r\n        )}\r\n      </span>\r\n    </div>\r\n    <div className=\"yyx-layout row yyx-space-v\">\r\n      <span className=\"item label\">效果抵抗</span>\r\n      <span className=\"item attr-value\">\r\n        {formatAttrValue(\r\n          1 + hero.attrs.effect_resist_rate - 1,\r\n          AttrValueType.Percentage\r\n        )}\r\n      </span>\r\n    </div>\r\n    <div className=\"yyx-layout row\">\r\n      <span className=\"item label\">攻击 x 暴伤</span>\r\n      <span className=\"item attr-value\">\r\n        {formatAttrValue(\r\n          hero.attrs.attack.value * (1 + hero.attrs.crit_power.value)\r\n        )}\r\n      </span>\r\n    </div>\r\n    <div className=\"yyx-layout row\">\r\n      <span className=\"item label\">生命 x 暴伤</span>\r\n      <span className=\"item attr-value\">\r\n        {formatAttrValue(\r\n          hero.attrs.max_hp.value * (1 + hero.attrs.crit_power.value)\r\n        )}\r\n      </span>\r\n    </div>\r\n    <div className=\"yyx-layout row\">\r\n      <span className=\"item label\">获取时间</span>\r\n      <span className=\"item attr-value\">\r\n        {formatTimestamp(hero.timestamp_from_id)}\r\n      </span>\r\n    </div>\r\n  </div>\r\n);\r\n\r\nexport const HeroDetail: SFC<{\r\n  hero: IHero;\r\n}> = props => {\r\n  const { hero } = props;\r\n\r\n  if (!hero.data) {\r\n    return null;\r\n  }\r\n\r\n  const ratings =\r\n    hero.awake > 0\r\n      ? hero.data.attr_rating.awake\r\n      : hero.data.attr_rating.unawake;\r\n\r\n  return (\r\n    <div className=\"hero-detail yyx-layout row\">\r\n      <div className=\"item\">\r\n        {renderIconName(hero)}\r\n        {renderAttrs(hero, ratings)}\r\n      </div>\r\n      <div className=\"item equips\">\r\n        <Equips\r\n          ids={hero.equips}\r\n          render={equips => <EquipSet equips={equips} />}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { SFC, useRef } from \"react\";\r\nimport \"./HeroDetailOverlay.scss\";\r\nimport { IHero } from \"../../interfaces\";\r\nimport { Overlay } from \"@blueprintjs/core\";\r\nimport { HeroDetail } from \"./HeroDetail\";\r\nimport { getHeroData } from \"../../modules/hero/data\";\r\n\r\nexport interface HeroDetailOverlayProps {\r\n  hero: IHero | null;\r\n  onClose: () => void;\r\n}\r\n\r\nexport const HeroDetailOverlay: SFC<HeroDetailOverlayProps> = props => {\r\n  const contentEl = useRef<HTMLDivElement>(null);\r\n\r\n  return (\r\n    <Overlay\r\n      className=\"hero-detail-overlay\"\r\n      backdropClassName=\"hero-detail-overlay-backdrop\"\r\n      isOpen={!!props.hero}\r\n      onClose={() => {\r\n        if (contentEl.current) {\r\n          contentEl.current.classList.add(\"closing\");\r\n        }\r\n        props.onClose();\r\n      }}\r\n    >\r\n      {props.hero && (\r\n        <div ref={contentEl} className=\"content\">\r\n          <div style={{ flex: \"0 0 auto\" }}>\r\n            <HeroDetail hero={props.hero} />\r\n          </div>\r\n          {/* <pre\r\n            style={{ height: 400, maxWidth: 600, overflow: \"auto\", flex: \"1\" }}\r\n          >\r\n            {JSON.stringify(props.hero, null, \"  \")}\r\n          </pre> */}\r\n        </div>\r\n      )}\r\n    </Overlay>\r\n  );\r\n};\r\n","// https://dev.to/gabe_ragland/debouncing-with-react-hooks-jci\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\n\r\n// Our hook\r\nexport function useDebounce<T>(value: T, delay: number) {\r\n  // State and setters for debounced value\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n\r\n  useEffect(() => {\r\n    // Set debouncedValue to value (passed in) after the specified delay\r\n    const handler = setTimeout(() => {\r\n      setDebouncedValue(value);\r\n    }, delay);\r\n\r\n    // Return a cleanup function that will be called every time ...\r\n    // ... useEffect is re-called. useEffect will only be re-called ...\r\n    // ... if value changes (see the inputs array below).\r\n    // This is how we prevent debouncedValue from changing if value is ...\r\n    // ... changed within the delay period. Timeout gets cleared and restarted.\r\n    // To put it in context, if the user is typing within our app's ...\r\n    // ... search box, we don't want the debouncedValue to update until ...\r\n    // ... they've stopped typing for more than 500ms.\r\n    return () => {\r\n      clearTimeout(handler);\r\n    };\r\n  }, // Only re-call effect if value changes\r\n  // You could also add the \"delay\" var to inputs array if you ...\r\n  // ... need to be able to change that dynamically.\r\n  [value]);\r\n\r\n  return debouncedValue;\r\n}\r\n","import React, { SFC, useState, useEffect } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { IHero, HeroRarity } from \"../../interfaces\";\r\nimport { IYyxState, IDispatch } from \"../../store\";\r\nimport { HeroGrid } from \"./HeroGrid\";\r\nimport { HeroDetailOverlay } from \"./HeroDetailOverlay\";\r\nimport {\r\n  HeroSelectors,\r\n  RarityOption,\r\n  IHeroFolded,\r\n  IHeroListOptions,\r\n  HeroActions,\r\n  ActionType\r\n} from \"../../modules/hero\";\r\nimport { Card, Switch, Button, MenuItem, InputGroup } from \"@blueprintjs/core\";\r\nimport { Select, ItemRenderer } from \"@blueprintjs/select\";\r\nimport { Rarity } from \"../Common/Rarity\";\r\nimport { useDebounce } from \"../../hooks/debounce\";\r\n\r\nconst RaritySelect = Select.ofType<RarityOption>();\r\nconst RarityOptions = [\r\n  \"*\",\r\n  HeroRarity.SP,\r\n  HeroRarity.SSR,\r\n  HeroRarity.SR,\r\n  HeroRarity.R,\r\n  HeroRarity.N,\r\n  \"M\"\r\n] as Array<RarityOption>;\r\n\r\nconst getRarityElem = (option: RarityOption) => {\r\n  let elem;\r\n  if (option === \"M\") {\r\n    elem = \"素材\";\r\n  } else if (option === \"*\") {\r\n    elem = \"全部\";\r\n  } else {\r\n    elem = <Rarity rarity={option} />;\r\n  }\r\n  return elem;\r\n};\r\n\r\nconst renderRarityOption: ItemRenderer<RarityOption> = (option, params) => {\r\n  let text = getRarityElem(option);\r\n  return (\r\n    <MenuItem\r\n      key={option}\r\n      text={text}\r\n      onClick={params.handleClick}\r\n      active={params.modifiers.active}\r\n    />\r\n  );\r\n};\r\n\r\nconst StarSelect = Select.ofType<number>();\r\nconst StarOptions = [0, 6, 5, 4, 3, 2];\r\nconst renderStarOption: ItemRenderer<number> = (option, params) => {\r\n  let text;\r\n  if (option === 0) {\r\n    text = \"全部\";\r\n  } else {\r\n    text = `${option}星`;\r\n  }\r\n  return (\r\n    <MenuItem\r\n      key={option}\r\n      text={text}\r\n      onClick={params.handleClick}\r\n      active={params.modifiers.active}\r\n    />\r\n  );\r\n};\r\n\r\nconst Render: SFC<{\r\n  heroes: (IHero | IHeroFolded)[] | null;\r\n  count: number;\r\n  mapById: Map<string, IHero> | null;\r\n  dispatch: IDispatch;\r\n}> = props => {\r\n  const { dispatch } = props;\r\n\r\n  const [activeHero, setActiveHero] = useState<IHero | null>(null);\r\n  const [fold, setFold] = useState(true);\r\n  const [rarity, setRarity] = useState<RarityOption>(\"*\");\r\n  const [star, setStar] = useState(0);\r\n  const [term, setTerm] = useState(\"\");\r\n  const debouncedTerm = useDebounce(term, 300);\r\n\r\n  // useEffect(() => {\r\n  //   if (props.heroes) {\r\n  //     setActiveHero(\r\n  //       (props.heroes.find(\r\n  //         i => \"id\" in i && i.id === \"5c3b92123938a33e4fa654e1\"\r\n  //       ) as IHero) || null\r\n  //     );\r\n  //   }\r\n  // }, [props.heroes]);\r\n\r\n  useEffect(() => {\r\n    dispatch(\r\n      HeroActions.setListOptions({\r\n        fold: fold && !debouncedTerm,\r\n        rarity,\r\n        star,\r\n        term: debouncedTerm\r\n      })\r\n    );\r\n  }, [fold, rarity, star, debouncedTerm]);\r\n\r\n  if (!props.heroes) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <HeroDetailOverlay\r\n        hero={activeHero}\r\n        onClose={() => setActiveHero(null)}\r\n      />\r\n      <Card className=\"yyx-space-v yyx-layout wrap row yyx-options\">\r\n        <div className=\"item\">\r\n          <InputGroup\r\n            leftIcon=\"filter\"\r\n            placeholder=\"搜索式神名称/昵称...\"\r\n            value={term}\r\n            onChange={(e: any) => setTerm(e.target.value)}\r\n          />\r\n        </div>\r\n        <div className=\"item\">\r\n          <RaritySelect\r\n            filterable={false}\r\n            items={RarityOptions}\r\n            itemRenderer={renderRarityOption}\r\n            onItemSelect={item => {\r\n              setRarity(item);\r\n            }}\r\n          >\r\n            <Button>\r\n              <div className=\"yyx-layout row\">\r\n                稀有度: {getRarityElem(rarity)}\r\n              </div>\r\n            </Button>\r\n          </RaritySelect>\r\n        </div>\r\n        <div className=\"item\">\r\n          <StarSelect\r\n            filterable={false}\r\n            items={StarOptions}\r\n            itemRenderer={renderStarOption}\r\n            onItemSelect={item => setStar(item)}\r\n          >\r\n            <Button>星级: {star ? `${star}星` : \"全部\"}</Button>\r\n          </StarSelect>\r\n        </div>\r\n        <div style={{ flex: 1 }}>数量: {props.count}</div>\r\n        <div className=\"item\">\r\n          <Switch\r\n            checked={fold}\r\n            onChange={() => setFold(!fold)}\r\n            className=\"item\"\r\n            label=\"折叠\"\r\n          />\r\n        </div>\r\n      </Card>\r\n      <HeroGrid\r\n        items={props.heroes}\r\n        onClickHero={item => {\r\n          item.id &&\r\n            setActiveHero(\r\n              (props.mapById && props.mapById.get(item.id)) || null\r\n            );\r\n          console.log(item);\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport const HeroList = connect((state: IYyxState) => ({\r\n  heroes: HeroSelectors.selectList(state),\r\n  count: HeroSelectors.selectCount(state),\r\n  mapById: HeroSelectors.selectMapById(state)\r\n}))(Render);\r\n","import { createSelector } from \"reselect\";\r\nimport { IHeroBookShard } from \"../../interfaces\";\r\nimport { SnapshotSelectors } from \"../snapshot\";\r\nimport { sortDesc, combineSorters } from \"../../utils\";\r\nimport { getHeroData, RarityRank } from \"../hero/data\";\r\n\r\nconst selectAll = createSelector(\r\n  SnapshotSelectors.selectCurrentSnapshot,\r\n  snapshot => {\r\n    if (!snapshot) {\r\n      return null;\r\n    }\r\n    return snapshot.data.hero_book_shards.map(i => {\r\n      i.hero_data = getHeroData(i.hero_id);\r\n      return i;\r\n    });\r\n  }\r\n);\r\n\r\nconst getRarityRank = (s: IHeroBookShard) =>\r\n  s.hero_data ? RarityRank[s.hero_data.rarity] : 999;\r\n\r\nconst defaultSorter = combineSorters<IHeroBookShard>(\r\n  sortDesc((a, b) => getRarityRank(a) - getRarityRank(b)),\r\n  sortDesc((a, b) => a.hero_id - b.hero_id)\r\n);\r\n\r\nconst selectSorted = createSelector(\r\n  selectAll,\r\n  items => {\r\n    if (!items) {\r\n      return null;\r\n    }\r\n\r\n    return items\r\n      .slice()\r\n      .filter(i => i.shards > 0 || i.books > 0)\r\n      .sort(defaultSorter);\r\n  }\r\n);\r\n\r\nexport const ShardSelectors = {\r\n  selectSorted\r\n};\r\n","import React, { SFC, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { IYyxState } from \"../../../store\";\r\nimport { ShardSelectors } from \"../../../modules/shard\";\r\nimport { IHeroBookShard } from \"../../../interfaces\";\r\nimport { Rarity } from \"../../Common/Rarity\";\r\n\r\nconst Render: SFC<{\r\n  items: IHeroBookShard[] | null;\r\n}> = props => {\r\n  if (!props.items) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <table className=\"bp3-html-table bp3-html-table-striped\">\r\n        <thead>\r\n          <tr>\r\n            <th>式神</th>\r\n            <th>拥有碎片</th>\r\n            <th>所需碎片</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {props.items.map(\r\n            i =>\r\n              i.hero_data && (\r\n                <tr key={i.hero_id}>\r\n                  <td\r\n                    className=\"yyx-layout row\"\r\n                    style={{ justifyContent: \"flex-start\" }}\r\n                  >\r\n                    <Rarity\r\n                      rarity={i.hero_data.rarity}\r\n                      className=\"yyx-space-h\"\r\n                    />\r\n                    {i.hero_data.name}\r\n                  </td>\r\n                  <td>{i.shards + i.books * i.book_max_shards}</td>\r\n                  <td>{i.book_max_shards}</td>\r\n                </tr>\r\n              )\r\n          )}\r\n        </tbody>\r\n      </table>\r\n    </>\r\n  );\r\n};\r\n\r\nexport const ShardPage = connect((state: IYyxState) => ({\r\n  items: ShardSelectors.selectSorted(state)\r\n}))(Render);\r\n","import SKILL_LEVEL_DATA from \"./SKILL_LEVEL_DATA.json\";\r\nimport { number } from \"prop-types\";\r\nimport { computeOnce } from \"../../utils\";\r\n\r\nexport const getSkillMaxLevelMap = computeOnce(() => {\r\n  return SKILL_LEVEL_DATA.reduce((m, i) => {\r\n    m.set(i[0], i[2]);\r\n    return m;\r\n  }, new Map<number, number>());\r\n});\r\n","import React, { SFC, useState } from \"react\";\r\nimport \"./SkillPage.scss\";\r\nimport { connect } from \"react-redux\";\r\nimport { IYyxState } from \"../../../store\";\r\nimport {\r\n  IHeroBookShard,\r\n  IHeroData,\r\n  HeroRarity,\r\n  IHero\r\n} from \"../../../interfaces\";\r\nimport { ALL_HERO_DATA, RarityRank } from \"../../../modules/hero/data\";\r\nimport { HeroDataIcon } from \"../HeroIcon\";\r\nimport { computeOnce } from \"../../../utils\";\r\nimport { getSkillMaxLevelMap } from \"../../../modules/skill/data\";\r\nimport { HeroSelectors } from \"../../../modules/hero\";\r\nimport { Icon } from \"@blueprintjs/core\";\r\n\r\ninterface Item {\r\n  data: IHeroData;\r\n  all_skills: number[];\r\n  skill_max_levels: number[];\r\n}\r\n\r\nconst getDataList = computeOnce<Item[]>(() => {\r\n  const SkillMaxLevelMap = getSkillMaxLevelMap();\r\n  return ALL_HERO_DATA.filter(\r\n    i => RarityRank[i.rarity] >= RarityRank[HeroRarity.SR]\r\n  )\r\n    .sort((a, b) => -(RarityRank[a.rarity] - RarityRank[b.rarity]))\r\n    .map(data => {\r\n      const all_skills = [\r\n        ...data.skills,\r\n        ...(data.awake_skill ? [data.awake_skill] : [])\r\n      ].sort();\r\n      return {\r\n        data,\r\n        all_skills,\r\n        skill_max_levels: all_skills.map(s => SkillMaxLevelMap.get(s) || 0)\r\n      };\r\n    });\r\n});\r\n\r\nconst formatUpgrade = (hero: IHero, item: Item) => {\r\n  let done = true;\r\n  const numbers = item.all_skills.map((s, i) => {\r\n    const skill = hero.skills.find(skill => skill.id === s);\r\n    const max = item.skill_max_levels[i];\r\n    const level = skill ? skill.level : 1;\r\n    const color =\r\n      level === max ? \"#0A6640\" : level === 1 ? \"#BFCCD6\" : \"#FFC940\";\r\n    done = done && level === max;\r\n    return (\r\n      <span key={s} style={{ color }}>\r\n        {level}\r\n      </span>\r\n    );\r\n  });\r\n  return <div className=\"levels\">{numbers}</div>;\r\n};\r\n\r\nconst Render: SFC<{\r\n  heroesMap: Map<number, IHero[]> | null;\r\n}> = props => {\r\n  if (!props.heroesMap) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <table className=\"bp3-html-table bp3-html-table-striped skill-table\">\r\n        <thead>\r\n          <tr>\r\n            <th>式神</th>\r\n            <th>技能最大等级</th>\r\n            <th>升级</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {getDataList().map(i => {\r\n            const heroes =\r\n              (props.heroesMap && props.heroesMap.get(i.data.id)) || [];\r\n            return (\r\n              <tr key={i.data.id}>\r\n                <td>\r\n                  <HeroDataIcon data={i.data} />\r\n                </td>\r\n                <td>\r\n                  <div className=\"levels big\">\r\n                    {i.skill_max_levels.map((l, i) => (\r\n                      <span key={i}>{l}</span>\r\n                    ))}\r\n                  </div>\r\n                </td>\r\n                <td>\r\n                  {heroes.length ? (\r\n                    <ul className=\"bp3-list bp3-list-unstyled\">\r\n                      {heroes.map(h => (\r\n                        <li key={h.id}>{formatUpgrade(h, i)}</li>\r\n                      ))}\r\n                    </ul>\r\n                  ) : (\r\n                    <span className=\"bp3-text-muted\">未获取</span>\r\n                  )}\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </>\r\n  );\r\n};\r\n\r\nexport const SkillPage = connect((state: IYyxState) => ({\r\n  heroesMap: HeroSelectors.selectMapByHeroId(state)\r\n}))(Render);\r\n","import React, { SFC } from \"react\";\r\nimport { SubNav, SubNavLink } from \"../Common/SubNav\";\r\nimport { HeroList } from \"./HeroList\";\r\nimport { Route } from \"react-router\";\r\nimport { ShardPage } from \"./Shard/ShardPage\";\r\nimport { SkillPage } from \"./Skill/SkillPage\";\r\n\r\nconst SubPages: (SubNavLink & { component: any })[] = [\r\n  {\r\n    label: \"式神列表\",\r\n    to: \"/hero\",\r\n    component: HeroList\r\n  },\r\n  {\r\n    label: \"碎片\",\r\n    to: \"/hero/shard\",\r\n    component: ShardPage\r\n  },\r\n  {\r\n    label: \"技能升级\",\r\n    to: \"/hero/skill\",\r\n    component: SkillPage\r\n  }\r\n];\r\n\r\nexport const HeroPage: SFC = props => {\r\n  return (\r\n    <div className=\"yyx-full-height yyx-layout row\">\r\n      <div className=\"item yyx-nav-left\">\r\n        <SubNav links={SubPages} />\r\n      </div>\r\n      <div className=\"item yyx-content yyx-content-scroll\">\r\n        <div className=\"yyx-padding\">\r\n          {SubPages.map(page => (\r\n            <Route\r\n              key={page.to}\r\n              path={page.to}\r\n              exact={page.to === \"/hero\"}\r\n              component={page.component}\r\n            />\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { SFC } from \"react\";\r\nimport \"./EquipGrid.scss\";\r\nimport { IHeroEquip } from \"../../interfaces\";\r\nimport { EquipItem } from \"./EquipItem\";\r\n\r\nexport interface EquipGridProps {\r\n  items: IHeroEquip[];\r\n  onClickEquip?: (equip: IHeroEquip) => void;\r\n}\r\n\r\nexport const EquipGrid: SFC<EquipGridProps> = props => {\r\n  return (\r\n    <div className=\"hero-equip-grid\">\r\n      <div className=\"hero-equip-grid-container\">\r\n        {props.items.map(i => (\r\n          <EquipItem\r\n            key={i.id}\r\n            className=\"hero-equip-grid-item\"\r\n            equip={i}\r\n            onClickEquip={props.onClickEquip}\r\n          />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { SFC, useState, useEffect } from \"react\";\r\nimport \"./EquipTypeSelector.scss\";\r\n\r\nimport {\r\n  Button,\r\n  MenuItem,\r\n  Dialog,\r\n  Classes,\r\n  Intent,\r\n  Tag,\r\n  Icon\r\n} from \"@blueprintjs/core\";\r\nimport { IHeroEquipSuitData } from \"../../interfaces\";\r\nimport { ALL_SUIT_DATA, getEquipSuiteData } from \"../../modules/equip/data\";\r\nimport { EquipTypeIcon } from \"./EquipIcon\";\r\nimport { getEquipSuitAttrName } from \"../../modules/equip/attr\";\r\n\r\nexport interface EquipTypeSelectorProps {\r\n  value?: IHeroEquipSuitData;\r\n  onChange?: (suitId: number) => void;\r\n}\r\n\r\nexport const EquipTypeSelector: SFC<EquipTypeSelectorProps> = props => {\r\n  return null;\r\n};\r\n\r\nexport interface EquipTypeMultiSelectorProps {\r\n  className?: string;\r\n  value?: number[];\r\n  onChange?: (suitIds: number[]) => void;\r\n}\r\n\r\n// const renderEquipType: ItemRenderer<IHeroEquipSuitData> = (option, params) => {\r\n//   return (\r\n//     <MenuItem\r\n//       key={option.id}\r\n//       text={option.name}\r\n//       onClick={params.handleClick}\r\n//       active={params.modifiers.active}\r\n//       labelElement={<EquipTypeIcon id={option.id} />}\r\n//     />\r\n//   );\r\n// };\r\n\r\nconst renderEquipTypeTag = (i: IHeroEquipSuitData) => {\r\n  return null;\r\n};\r\n\r\nconst EquipTypeDialog: SFC<{\r\n  multiple: boolean;\r\n  selected: number[];\r\n  setIdSelected: (id: number, selected: boolean) => void;\r\n  isOpen: boolean;\r\n  onOk: () => void;\r\n  onCancel: () => void;\r\n}> = props => {\r\n  return (\r\n    <Dialog isOpen={props.isOpen} onClose={() => props.onCancel()}>\r\n      <div className={Classes.DIALOG_BODY}>\r\n        <ul className=\"equip-type-dialog-type-list\">\r\n          {ALL_SUIT_DATA.map(i => {\r\n            const selected = props.selected.includes(i.id);\r\n            return (\r\n              <li\r\n                className={selected ? \"selected\" : \"\"}\r\n                key={i.id}\r\n                onClick={() => props.setIdSelected(i.id, !selected)}\r\n              >\r\n                <div className=\"content\">\r\n                  <EquipTypeIcon id={i.id} size={50} />\r\n                  <div className=\"description\">\r\n                    <span className=\"name\">{i.name}</span>\r\n                    <br />\r\n                    <Tag>{getEquipSuitAttrName(i)}</Tag>\r\n                  </div>\r\n                </div>\r\n                <div className=\"tick\">\r\n                  <Icon icon=\"small-tick\" />\r\n                </div>\r\n              </li>\r\n            );\r\n          })}\r\n        </ul>\r\n      </div>\r\n      <div className={Classes.DIALOG_FOOTER}>\r\n        <div className={Classes.DIALOG_FOOTER_ACTIONS}>\r\n          <Button onClick={() => props.onCancel()}>取消</Button>\r\n          <Button intent={Intent.PRIMARY} onClick={() => props.onOk()}>\r\n            确定\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nconst EmptyList: number[] = [];\r\n\r\nconst renderTypeList = (ids: number[]) => {\r\n  return (\r\n    <ul className=\"bp3-list-unstyled icon-list\">\r\n      {ids.map(id => {\r\n        return (\r\n          <li key={id}>\r\n            <EquipTypeIcon id={id} size={24} />\r\n          </li>\r\n        );\r\n      })}\r\n    </ul>\r\n  );\r\n};\r\n\r\nexport const EquipTypeMultiSelector: SFC<\r\n  EquipTypeMultiSelectorProps\r\n> = props => {\r\n  const [dialogOpen, setDialogOpen] = useState(false);\r\n  const [dialogSelected, setDialogSelected] = useState(EmptyList);\r\n  const [selected, setSelected] = useState(props.value || EmptyList);\r\n\r\n  return (\r\n    <div className={props.className}>\r\n      <EquipTypeDialog\r\n        isOpen={dialogOpen}\r\n        onCancel={() => {\r\n          setDialogOpen(false);\r\n        }}\r\n        onOk={() => {\r\n          setDialogOpen(false);\r\n          setSelected(dialogSelected);\r\n          if (props.onChange) {\r\n            props.onChange(dialogSelected);\r\n          }\r\n        }}\r\n        multiple\r\n        selected={dialogSelected}\r\n        setIdSelected={(id, idSelected) => {\r\n          setDialogSelected(\r\n            idSelected\r\n              ? [...dialogSelected.filter(v => v !== id), id]\r\n              : dialogSelected.filter(v => v !== id)\r\n          );\r\n        }}\r\n      />\r\n      <Button\r\n        className=\"equip-type-selector-button\"\r\n        onClick={() => {\r\n          setDialogSelected(selected);\r\n          setDialogOpen(true);\r\n        }}\r\n      >\r\n        <div className=\"yyx-layout row wrap\">\r\n          {selected.length ? renderTypeList(selected) : <span>全部</span>}\r\n        </div>\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n","import React, { SFC, useState, useEffect } from \"react\";\r\nimport classNames from \"classnames\";\r\nimport \"./EquipPosition.scss\";\r\n\r\nconst Labels = [\"\", \"壹\", \"贰\", \"叁\", \"肆\", \"伍\", \"陆\"];\r\n\r\nexport const EquipPosition: SFC<{\r\n  className?: string;\r\n  labelElement?: (pos: number) => React.ReactNode;\r\n  position: number;\r\n  active?: boolean;\r\n  onClick?: (pos: number) => void;\r\n}> = props => {\r\n  return (\r\n    <div\r\n      className={classNames(\r\n        \"equip-position\",\r\n        `pos-${props.position}`,\r\n        props.onClick && \"clickable\",\r\n        props.active && \"active\",\r\n        props.className\r\n      )}\r\n      onClick={() => props.onClick && props.onClick(props.position)}\r\n    >\r\n      <div className=\"content\">\r\n        {props.labelElement ? (\r\n          props.labelElement(props.position)\r\n        ) : (\r\n          <div className=\"equip-position-text\">{Labels[props.position]}</div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import { HttpClient } from \"../http\";\r\n\r\nexport function exportJson(filename: string, value: any) {\r\n  return HttpClient.post<string>(\"/api/export/json\", value, {\r\n    params: {\r\n      filename\r\n    }\r\n  }).then(res => res.data);\r\n}\r\n","import {\r\n  IHeroEquip,\r\n  HeroEquipAttrType,\r\n  ISnapshot,\r\n  IHeroEquipSuitData\r\n} from \"../../interfaces\";\r\nconst DATA = require(\"./EQUIP_SUIT_DATA.json\");\r\n\r\nexport const ALL_SUIT_DATA: IHeroEquipSuitData[] = DATA;\r\nexport interface Ocr2Item {\r\n  御魂ID: string;\r\n  御魂等级: number;\r\n  御魂星级: number;\r\n  御魂类型: string;\r\n  位置: number;\r\n  生命?: number;\r\n  防御?: number;\r\n  攻击?: number;\r\n  生命加成?: number;\r\n  防御加成?: number;\r\n  攻击加成?: number;\r\n  速度?: number;\r\n  暴击?: number;\r\n  暴击伤害?: number;\r\n  效果命中?: number;\r\n  效果抵抗?: number;\r\n}\r\n\r\nconst AttrNameMap = {\r\n  Hp: \"生命\",\r\n  Defense: \"防御\",\r\n  Attack: \"攻击\",\r\n  HpRate: \"生命加成\",\r\n  DefenseRate: \"防御加成\",\r\n  AttackRate: \"攻击加成\",\r\n  Speed: \"速度\",\r\n  CritRate: \"暴击\",\r\n  CritPower: \"暴击伤害\",\r\n  EffectHitRate: \"效果命中\",\r\n  EffectResistRate: \"效果抵抗\"\r\n};\r\n\r\nconst SuitMap: { [id: string]: string } = ALL_SUIT_DATA.reduce(\r\n  (map, i) => {\r\n    map[String(i.id)] = i.name;\r\n    return map;\r\n  },\r\n  {} as { [id: string]: string }\r\n);\r\n\r\nexport function equipsToOcr2(\r\n  equips: IHeroEquip[]\r\n): (\"yuhun_ocr2.0\" | Ocr2Item)[] {\r\n  const items = equips.map(equip => {\r\n    const item = {\r\n      御魂ID: equip.id,\r\n      御魂等级: equip.level,\r\n      御魂星级: equip.quality,\r\n      御魂类型: SuitMap[String(equip.suit_id)],\r\n      位置: equip.pos + 1\r\n    };\r\n    const attrMap: { [key: string]: number } = {};\r\n    for (let attr of [equip.base_attr, ...equip.attrs, ...equip.single_attrs]) {\r\n      const v = attrMap[attr.type] || 0;\r\n      attrMap[attr.type] = v + attr.value;\r\n    }\r\n    Object.keys(attrMap).forEach(k => {\r\n      (item as any)[(AttrNameMap as any)[k] as any] = attrMap[k];\r\n    });\r\n    return item;\r\n  });\r\n  return [\"yuhun_ocr2.0\", ...items];\r\n}\r\n\r\nexport function snapshotToOcr2(\r\n  shanpshot: ISnapshot\r\n): (\"yuhun_ocr2.0\" | Ocr2Item)[] {\r\n  return equipsToOcr2(shanpshot.data.hero_equips);\r\n}\r\n","import React, { SFC, useState, useEffect, EventHandler } from \"react\";\r\nimport \"./EquipList.scss\";\r\nimport { connect } from \"react-redux\";\r\nimport { IHeroEquip, HeroEquipAttrType, ISnapshot } from \"../../interfaces\";\r\nimport { IYyxState, IDispatch } from \"../../store\";\r\nimport {\r\n  EquipSelectors,\r\n  EquipActions,\r\n  IEquipListOptions,\r\n  EquipLevelFilter,\r\n  EquipEquippedFilter\r\n} from \"../../modules/equip\";\r\nimport { EquipGrid } from \"./EquipGrid\";\r\nimport {\r\n  Card,\r\n  Button,\r\n  Divider,\r\n  ButtonGroup,\r\n  InputGroup,\r\n  Callout\r\n} from \"@blueprintjs/core\";\r\nimport { EquipTypeMultiSelector } from \"./EquipTypeSelector\";\r\nimport { EquipPosition } from \"./EquipPosition\";\r\nimport {\r\n  HeroEquipPosAttrBaseTypes,\r\n  getEquipAttrName\r\n} from \"../../modules/equip/attr\";\r\nimport { useDebounce } from \"../../hooks/debounce\";\r\nimport classNames from \"classnames\";\r\nimport { DateInput } from \"@blueprintjs/datetime\";\r\nimport { formatDate, parseDate } from \"../../utils\";\r\nimport { SnapshotInfo } from \"../Snapshot/SnapshotInfo\";\r\nimport { exportJson } from \"../../modules/equip/export\";\r\nimport { equipsToOcr2 } from \"../../modules/equip/ocr2\";\r\n\r\nconst renderPositions = (\r\n  value: number[],\r\n  onClick: (value: number, active: boolean) => void\r\n) => {\r\n  const nodes = [];\r\n  for (let i = 1; i <= 6; i++) {\r\n    const active = value.includes(i);\r\n    nodes.push(\r\n      <EquipPosition\r\n        key={i}\r\n        active={active}\r\n        position={i}\r\n        onClick={() => onClick(i, active)}\r\n      />\r\n    );\r\n  }\r\n  return <ButtonGroup>{nodes}</ButtonGroup>;\r\n};\r\n\r\nconst renderStars = (\r\n  value: number[],\r\n  onClick: (value: number, active: boolean) => void\r\n) => {\r\n  const nodes = [];\r\n  for (let i = 1; i <= 6; i++) {\r\n    const active = value.includes(i);\r\n    nodes.push(\r\n      <Button key={i} active={active} onClick={() => onClick(i, active)}>\r\n        {i}星\r\n      </Button>\r\n    );\r\n  }\r\n  return <ButtonGroup>{nodes}</ButtonGroup>;\r\n};\r\n\r\nfunction getBaseAttrList(positions: number[]): HeroEquipAttrType[] {\r\n  return Array.from(\r\n    new Set(\r\n      positions\r\n        .map(pos => HeroEquipPosAttrBaseTypes.get(pos) || [])\r\n        .reduce((l, r) => [...l, ...r], [])\r\n    )\r\n  );\r\n}\r\n\r\nconst renderBaseAttrs = (\r\n  positions: number[],\r\n  value: HeroEquipAttrType[] | null,\r\n  onChange: (value: HeroEquipAttrType, active: boolean) => void\r\n) => {\r\n  if (!positions.length) {\r\n    return (\r\n      <Button minimal disabled alignText=\"left\">\r\n        请选择位置\r\n      </Button>\r\n    );\r\n  }\r\n\r\n  const attrs = getBaseAttrList(positions);\r\n  return (\r\n    <ButtonGroup>\r\n      {attrs.map(type => {\r\n        const active = !!(value && value.includes(type));\r\n        return (\r\n          <Button\r\n            active={active}\r\n            key={type}\r\n            onClick={() => onChange(type, active)}\r\n            disabled={attrs.length === 1}\r\n          >\r\n            {getEquipAttrName(type)}\r\n          </Button>\r\n        );\r\n      })}\r\n    </ButtonGroup>\r\n  );\r\n};\r\n\r\nconst renderScores = (\r\n  value: number[],\r\n  onClick: (value: number, active: boolean) => void\r\n) => {\r\n  const nodes = [];\r\n  for (let i = 3; i <= 9; i++) {\r\n    const active = value.includes(i);\r\n    nodes.push(\r\n      <Button key={i} active={active} onClick={() => onClick(i, active)}>\r\n        {i}分\r\n      </Button>\r\n    );\r\n  }\r\n  return <ButtonGroup>{nodes}</ButtonGroup>;\r\n};\r\n\r\nconst DefaultListOptions: IEquipListOptions = {\r\n  id: \"\",\r\n  types: null,\r\n  positions: [],\r\n  stars: [6],\r\n  baseAttrs: null,\r\n  trashed: false,\r\n  level: EquipLevelFilter.Max,\r\n  equipped: EquipEquippedFilter.Any,\r\n  creationTimeFrom: null,\r\n  creationTimeTo: null,\r\n  scores: []\r\n};\r\n\r\nconst Render: SFC<{\r\n  equips: IHeroEquip[] | null;\r\n  dispatch: IDispatch;\r\n}> = props => {\r\n  const [options, _setOptions] = useState<IEquipListOptions>(\r\n    DefaultListOptions\r\n  );\r\n  const debouncedOptions = useDebounce(options, 500);\r\n  const [loading, setLoading] = useState(false);\r\n  const [exporting, setExporting] = useState(false);\r\n  const [exported, setExported] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (debouncedOptions) {\r\n      props.dispatch(EquipActions.setListOptions(debouncedOptions));\r\n      setLoading(false);\r\n    }\r\n  }, [debouncedOptions]);\r\n\r\n  const setOptions = (v: IEquipListOptions) => {\r\n    _setOptions(v);\r\n    setLoading(true);\r\n  };\r\n\r\n  if (!props.equips) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"yyx-full-height yyx-layout row\">\r\n      <Card className=\"yyx-nav-left item yyx-options equip-list-options\">\r\n        <div className=\"item\">\r\n          <InputGroup\r\n            leftIcon=\"filter\"\r\n            placeholder=\"搜索御魂ID\"\r\n            value={options.id}\r\n            onChange={(e: any) =>\r\n              setOptions({\r\n                ...options,\r\n                id: e.target.value\r\n              })\r\n            }\r\n          />\r\n        </div>\r\n        <Divider className=\"item\" />\r\n        <div className=\"yyx-layout row item\">\r\n          <label className=\"item\">类型: </label>\r\n          <EquipTypeMultiSelector\r\n            className=\"item\"\r\n            onChange={types =>\r\n              setOptions({\r\n                ...options,\r\n                types\r\n              })\r\n            }\r\n          />\r\n        </div>\r\n        <div className=\"item yyx-layout row\">\r\n          <label className=\"item\">位置: </label>\r\n          <div className=\"item pos-icons\">\r\n            {renderPositions(options.positions, (pos, active) => {\r\n              let positions;\r\n              if (active) {\r\n                positions = options.positions.filter(p => p !== pos);\r\n              } else {\r\n                positions = [...options.positions.filter(p => p !== pos), pos];\r\n              }\r\n              setOptions({\r\n                ...options,\r\n                positions\r\n              });\r\n            })}\r\n          </div>\r\n        </div>\r\n        <div className=\"item yyx-layout row\">\r\n          <label className=\"item\">星级: </label>\r\n          <div className=\"item\">\r\n            {renderStars(options.stars, (star, active) => {\r\n              let stars;\r\n              if (active) {\r\n                stars = options.stars.filter(s => s !== star);\r\n              } else {\r\n                stars = [...options.stars.filter(s => s !== star), star];\r\n              }\r\n              setOptions({\r\n                ...options,\r\n                stars\r\n              });\r\n            })}\r\n          </div>\r\n        </div>\r\n        <div className=\"item yyx-layout row \">\r\n          <label className=\"item\">主属性:</label>\r\n          <div className=\"item\">\r\n            {renderBaseAttrs(\r\n              options.positions,\r\n              options.baseAttrs,\r\n              (attr, active) => {\r\n                let attrs;\r\n                if (active) {\r\n                  attrs = options.baseAttrs\r\n                    ? options.baseAttrs.filter(a => a !== attr)\r\n                    : [];\r\n                } else {\r\n                  attrs = options.baseAttrs\r\n                    ? [...options.baseAttrs.filter(a => a !== attr), attr]\r\n                    : [attr];\r\n                }\r\n                setOptions({\r\n                  ...options,\r\n                  baseAttrs: attrs\r\n                });\r\n              }\r\n            )}\r\n          </div>\r\n        </div>\r\n        <div className=\"item yyx-layout row\">\r\n          <label className=\"item\">强化:</label>\r\n          <div className=\"item\">\r\n            <ButtonGroup>\r\n              <Button\r\n                active={options.level === EquipLevelFilter.Zero}\r\n                onClick={() => {\r\n                  setOptions({\r\n                    ...options,\r\n                    level:\r\n                      options.level === EquipLevelFilter.Zero\r\n                        ? EquipLevelFilter.Any\r\n                        : EquipLevelFilter.Zero\r\n                  });\r\n                }}\r\n              >\r\n                未强化\r\n              </Button>\r\n              <Button\r\n                active={options.level === EquipLevelFilter.Max}\r\n                onClick={() => {\r\n                  setOptions({\r\n                    ...options,\r\n                    level:\r\n                      options.level === EquipLevelFilter.Max\r\n                        ? EquipLevelFilter.Any\r\n                        : EquipLevelFilter.Max\r\n                  });\r\n                }}\r\n              >\r\n                +15\r\n              </Button>\r\n            </ButtonGroup>\r\n          </div>\r\n        </div>\r\n        <div className=\"item yyx-layout row\">\r\n          <label className=\"item\">装备:</label>\r\n          <div className=\"item\">\r\n            <ButtonGroup>\r\n              <Button\r\n                active={options.equipped === EquipEquippedFilter.NotEquipped}\r\n                onClick={() => {\r\n                  setOptions({\r\n                    ...options,\r\n                    equipped:\r\n                      options.equipped === EquipEquippedFilter.NotEquipped\r\n                        ? EquipEquippedFilter.Any\r\n                        : EquipEquippedFilter.NotEquipped\r\n                  });\r\n                }}\r\n              >\r\n                未装备\r\n              </Button>\r\n              <Button\r\n                active={options.equipped === EquipEquippedFilter.Equipped}\r\n                onClick={() => {\r\n                  setOptions({\r\n                    ...options,\r\n                    equipped:\r\n                      options.equipped === EquipEquippedFilter.Equipped\r\n                        ? EquipEquippedFilter.Any\r\n                        : EquipEquippedFilter.Equipped\r\n                  });\r\n                }}\r\n              >\r\n                装备\r\n              </Button>\r\n            </ButtonGroup>\r\n          </div>\r\n        </div>\r\n        <div className=\"item yyx-layout row\">\r\n          <label className=\"item\">弃置:</label>\r\n          <div className=\"item\">\r\n            <ButtonGroup>\r\n              <Button\r\n                active={options.trashed === false}\r\n                onClick={() => {\r\n                  setOptions({\r\n                    ...options,\r\n                    trashed: options.trashed === false ? null : false\r\n                  });\r\n                }}\r\n              >\r\n                未弃置\r\n              </Button>\r\n              <Button\r\n                active={options.trashed === true}\r\n                onClick={() => {\r\n                  setOptions({\r\n                    ...options,\r\n                    trashed: options.trashed === true ? null : true\r\n                  });\r\n                }}\r\n              >\r\n                已弃置\r\n              </Button>\r\n            </ButtonGroup>\r\n          </div>\r\n        </div>\r\n        {/* <div className=\"item yyx-layout row \">\r\n          <label className=\"item\">评分: </label>\r\n          <div className=\"item\">\r\n            {renderScores(options.scores, (score, active) => {\r\n              let scores;\r\n              if (active) {\r\n                scores = options.scores\r\n                  ? options.scores.filter(s => s !== score)\r\n                  : [];\r\n              } else {\r\n                scores = options.scores\r\n                  ? [...options.scores.filter(s => s !== score), score]\r\n                  : [score];\r\n              }\r\n              setOptions({\r\n                ...options,\r\n                scores\r\n              });\r\n            })}\r\n          </div>\r\n        </div> */}\r\n        <div className=\"item yyx-layout row\">\r\n          <label className=\"item\">获取时间:</label>\r\n          <div className=\"item\">\r\n            <DateInput\r\n              showActionsBar\r\n              placeholder=\"起始时间\"\r\n              timePrecision=\"minute\"\r\n              formatDate={formatDate}\r\n              parseDate={parseDate}\r\n              onChange={date =>\r\n                setOptions({\r\n                  ...options,\r\n                  creationTimeFrom: date\r\n                })\r\n              }\r\n              value={options.creationTimeFrom || undefined}\r\n            />\r\n            <br />\r\n            <DateInput\r\n              showActionsBar\r\n              formatDate={formatDate}\r\n              parseDate={parseDate}\r\n              placeholder=\"结束时间\"\r\n              timePrecision=\"minute\"\r\n              onChange={date =>\r\n                setOptions({\r\n                  ...options,\r\n                  creationTimeTo: date\r\n                })\r\n              }\r\n              value={options.creationTimeTo || undefined}\r\n            />\r\n          </div>\r\n          <div />\r\n        </div>\r\n        <Divider className=\"item\" />\r\n        <div className=\"item\">数量: {props.equips.length}</div>\r\n        <div className=\"item\">\r\n          <SnapshotInfo\r\n            render={info => (\r\n              <Button\r\n                intent={\"primary\"}\r\n                disabled={exporting}\r\n                onClick={async () => {\r\n                  if (info) {\r\n                    setExporting(true);\r\n                    const path = await exportOcr2Json(\r\n                      info,\r\n                      props.equips as IHeroEquip[]\r\n                    );\r\n                    setExported(path);\r\n                    setExporting(false);\r\n                  }\r\n                }}\r\n              >\r\n                导出JSON (御魂导出器)\r\n              </Button>\r\n            )}\r\n          />\r\n          <br />\r\n          <br />\r\n          {exported && (\r\n            <Callout intent={\"success\"}>\r\n              导出成功: <br />\r\n              <a href={`/export-files/${exported}`} target=\"_blank\">\r\n                {exported}\r\n              </a>\r\n            </Callout>\r\n          )}\r\n        </div>\r\n      </Card>\r\n      <Divider />\r\n      <div\r\n        className={classNames(\r\n          \"yyx-content yyx-content-scroll\",\r\n          \"item\",\r\n          loading && \"equip-list-loading\"\r\n        )}\r\n      >\r\n        <EquipGrid\r\n          items={props.equips}\r\n          onClickEquip={equip => {\r\n            console.log(equip);\r\n          }}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nasync function exportOcr2Json(\r\n  snapshotInfo: ISnapshot,\r\n  equips: IHeroEquip[]\r\n): Promise<string> {\r\n  const filename = `${snapshotInfo.data.player.name}_${\r\n    snapshotInfo.data.player.id\r\n  }_${formatDate(new Date(), \"YYYYMMDD_HHmm\")}.json`;\r\n  return exportJson(filename, equipsToOcr2(equips));\r\n}\r\n\r\nexport const EquipList = connect((state: IYyxState) => ({\r\n  equips: EquipSelectors.selectDisplay(state)\r\n}))(Render);\r\n","import React, { SFC, useState, useEffect } from \"react\";\r\nimport \"./EquipSetAttrs.scss\";\r\nimport { IEquipSetInfo } from \"../../modules/equip\";\r\n\r\nimport {\r\n  getEquipAttrName,\r\n  formatEquipAttrValue\r\n} from \"../../modules/equip/attr\";\r\nimport { formatAttrValue } from \"../../utils\";\r\nimport { HeroEquipAttrType } from \"../../interfaces\";\r\nimport classNames from \"classnames\";\r\nimport { EquipTypeIcon } from \"./EquipIcon\";\r\n\r\nconst AttrTable = [\r\n  [HeroEquipAttrType.Attack, HeroEquipAttrType.CritRate],\r\n  [HeroEquipAttrType.AttackRate, HeroEquipAttrType.CritPower],\r\n  [HeroEquipAttrType.Hp, HeroEquipAttrType.EffectHitRate],\r\n  [HeroEquipAttrType.HpRate, HeroEquipAttrType.EffectResistRate],\r\n  [HeroEquipAttrType.Defense, HeroEquipAttrType.Speed],\r\n  [HeroEquipAttrType.DefenseRate, null]\r\n];\r\n\r\nexport const EquipSetAttrs: SFC<{\r\n  className?: string;\r\n  info: IEquipSetInfo;\r\n}> = ({ className, info }) => {\r\n  return (\r\n    <div className={classNames(\"equip-set-attrs\", className)}>\r\n      <ul className=\"attr-list\">\r\n        {AttrTable.map(([l, r], idx) => {\r\n          return (\r\n            <li key={idx} className=\"yyx-layout row\">\r\n              {l && (\r\n                <div className=\"item yyx-layout row\">\r\n                  <label className=\"item\">{getEquipAttrName(l)}</label>\r\n                  <span className=\"item value\">\r\n                    {formatEquipAttrValue(l, info.attrMap.get(l) || 0, true)}\r\n                  </span>\r\n                </div>\r\n              )}\r\n              {r && (\r\n                <div className=\"item yyx-layout row\">\r\n                  <label className=\"item\">{getEquipAttrName(r)}</label>\r\n                  <span className=\"item value\">\r\n                    {formatEquipAttrValue(r, info.attrMap.get(r) || 0, true)}\r\n                  </span>\r\n                </div>\r\n              )}\r\n            </li>\r\n          );\r\n        })}\r\n      </ul>\r\n      <ul className=\"suit-effect-list\">\r\n        {info.suits.map(data => {\r\n          return (\r\n            <li key={data.id} className=\"yyx-layout row\">\r\n              <div className=\"item icon\">\r\n                <EquipTypeIcon id={data.id} size={24} />\r\n              </div>\r\n              <div className=\"item effect-desc\">\r\n                {data.effect[3][0] || data.effect[1][0]}\r\n              </div>\r\n            </li>\r\n          );\r\n        })}\r\n      </ul>\r\n    </div>\r\n  );\r\n};\r\n","import React, { SFC } from \"react\";\r\nimport \"./EquipPage.scss\";\r\nimport { SubNavLink, SubNav } from \"../Common/SubNav\";\r\nimport { EquipList } from \"./EquipList\";\r\nimport { Route } from \"react-router\";\r\nimport { EquipPresets } from \"./EquipPresets\";\r\n\r\nconst SubPages: (SubNavLink & { component: any })[] = [\r\n  {\r\n    label: \"御魂列表\",\r\n    to: \"/equip\",\r\n    component: EquipList\r\n  },\r\n  {\r\n    label: \"御魂方案\",\r\n    to: \"/equip/preset\",\r\n    component: EquipPresets\r\n  }\r\n];\r\n\r\nexport const EquipPage: SFC = props => {\r\n  return (\r\n    <div className=\"yyx-full-height yyx-layout row\">\r\n      <div className=\"item yyx-nav-left\">\r\n        <SubNav links={SubPages} />\r\n      </div>\r\n      <div className=\"item yyx-content yyx-content-scroll\">\r\n        {SubPages.map(page => (\r\n          <Route\r\n            key={page.to}\r\n            path={page.to}\r\n            exact={page.to === \"/equip\"}\r\n            component={page.component}\r\n          />\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { SFC, useState, useEffect } from \"react\";\r\nimport \"./EquipPresets.scss\";\r\nimport { connect } from \"react-redux\";\r\nimport {\r\n  IHeroEquip,\r\n  IHeroEquipPreset,\r\n  HeroEquipAttrType\r\n} from \"../../interfaces\";\r\nimport { IYyxState } from \"../../store\";\r\nimport { EquipSelectors, IEquipPresetItem } from \"../../modules/equip\";\r\nimport { Card, InputGroup, Divider } from \"@blueprintjs/core\";\r\nimport { Equips } from \"./Equips\";\r\nimport { EquipSet } from \"./EquipSet\";\r\nimport { useDebounce } from \"../../hooks/debounce\";\r\nimport { EquipSetAttrs } from \"./EquipSetAttrs\";\r\nimport { EquipTypeMultiSelector } from \"./EquipTypeSelector\";\r\n\r\nconst Render: SFC<{\r\n  presets: IEquipPresetItem[] | null;\r\n}> = props => {\r\n  const [term, setTerm] = useState(\"\");\r\n  const [suites, setSuites] = useState<number[]>([]);\r\n  const termDebounced = useDebounce(term.trim(), 300);\r\n  const [list, setList] = useState(props.presets);\r\n\r\n  useEffect(() => {\r\n    if (!props.presets) {\r\n      return;\r\n    }\r\n    let filteredList = props.presets;\r\n\r\n    if (suites.length) {\r\n      filteredList = filteredList.filter(p =>\r\n        suites.length < p.suits.length\r\n          ? p.suits.some(data => suites.includes(data.id))\r\n          : p.suits.length == suites.length &&\r\n            p.suits.every(data => suites.includes(data.id))\r\n      );\r\n    }\r\n\r\n    if (termDebounced) {\r\n      filteredList = filteredList.filter(p => p.name.includes(termDebounced));\r\n    }\r\n\r\n    setList(filteredList);\r\n  }, [props.presets, termDebounced, suites]);\r\n\r\n  const { presets } = props;\r\n\r\n  if (!presets || !list) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"yyx-padding\">\r\n      <Card className=\"yyx-layout row wrap yyx-options yyx-space-v\">\r\n        <div className=\"item\">\r\n          <InputGroup\r\n            leftIcon=\"filter\"\r\n            placeholder=\"搜索名称...\"\r\n            value={term}\r\n            onChange={(e: any) => setTerm(e.target.value)}\r\n          />\r\n        </div>\r\n        <div className=\"yyx-layout row item\">\r\n          <label className=\"item\">套装: </label>\r\n          <EquipTypeMultiSelector\r\n            className=\"item\"\r\n            onChange={types => setSuites(types)}\r\n          />\r\n        </div>\r\n        <div className=\"item\">数量: {list.length}</div>\r\n      </Card>\r\n      <ul className=\"bp3-list-unstyled equip-preset-list\">\r\n        {list.map((i, idx) => (\r\n          <li key={idx}>\r\n            <div className=\"yyx-layout row title\">\r\n              <div className=\"item name\">{i.name}</div>\r\n              <div className=\"item right\" />\r\n            </div>\r\n            <EquipSet equips={i.equips} />\r\n            <EquipSetAttrs info={i} />\r\n          </li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const EquipPresets = connect((state: IYyxState) => ({\r\n  presets: EquipSelectors.selectPresetItems(state)\r\n}))(Render);\r\n","import { IRealmCardData } from \"../../interfaces\";\r\n\r\nconst DATA = require(\"./REALM_CARD_DATA.json\");\r\n\r\nexport const RealmCardNames = [\r\n  \"太鼓\",\r\n  \"斗鱼\",\r\n  \"伞室内\",\r\n  \"太阴符咒\",\r\n  \"太阳符咒\",\r\n  \"伞结界\",\r\n  \"夜屏风\",\r\n  \"白桃林\",\r\n  \"胧车\",\r\n  \"鬼火烧\",\r\n  \"葫芦酒\",\r\n  \"口水蛙\",\r\n  \"孟婆汤\",\r\n  \"绵绵冰\",\r\n  \"千年笛\",\r\n  \"神乐铃\",\r\n  \"天雷鼓\",\r\n  \"阎琵琶\",\r\n  \"炼妖琴\"\r\n];\r\n\r\nconst DataMap: Map<number, IRealmCardData> = DATA.reduce(\r\n  (m: Map<number, IRealmCardData>, i: any) => {\r\n    m.set(i.id, i);\r\n    return m;\r\n  },\r\n  new Map()\r\n);\r\n\r\nexport const getRealmCardData = (itemId: number) => DataMap.get(itemId);\r\n","import { IAction, IDispatch, IYyxState } from \"../../store\";\r\nimport { createSelector } from \"reselect\";\r\nimport { IRealmCard, IRealmCardData } from \"../../interfaces\";\r\nimport { getRealmCardData, RealmCardNames } from \"./data\";\r\nimport { SnapshotSelectors } from \"../snapshot\";\r\nimport { sortDesc } from \"../../utils\";\r\n\r\nconst selectAll = createSelector(\r\n  SnapshotSelectors.selectCurrentSnapshot,\r\n  snapshot => {\r\n    if (!snapshot) {\r\n      return null;\r\n    }\r\n    return snapshot.data.realm_cards.map(c => {\r\n      c.data = getRealmCardData(c.item_id);\r\n      return c;\r\n    });\r\n  }\r\n);\r\n\r\nexport type IRealmCardGroupMapByName = Map<\r\n  string, // name\r\n  Array<{\r\n    item_id: number;\r\n    star: number;\r\n    count: number;\r\n  }>\r\n>;\r\n\r\nconst selectGroupMapByName = createSelector(\r\n  selectAll,\r\n  cards => {\r\n    if (!cards) {\r\n      return null;\r\n    }\r\n    const map: IRealmCardGroupMapByName = new Map();\r\n\r\n    cards\r\n      .slice()\r\n      .sort(\r\n        sortDesc((a, b) => {\r\n          return (a.data ? a.data.star : 0) - (b.data ? b.data.star : 0);\r\n        })\r\n      )\r\n      .forEach(c => {\r\n        const name = c.data && c.data.name;\r\n        const star = c.data && c.data.star;\r\n\r\n        if (name && star) {\r\n          let list = map.get(name);\r\n          if (!list) {\r\n            map.set(name, [\r\n              {\r\n                item_id: c.item_id,\r\n                star,\r\n                count: 1\r\n              }\r\n            ]);\r\n          } else {\r\n            const entry = list.find(i => i.item_id === c.item_id);\r\n            if (entry) {\r\n              entry.count++;\r\n            } else {\r\n              list.push({\r\n                item_id: c.item_id,\r\n                star,\r\n                count: 1\r\n              });\r\n            }\r\n          }\r\n        }\r\n      });\r\n\r\n    return map;\r\n  }\r\n);\r\n\r\nexport interface IRealmCardGroup {\r\n  name: string;\r\n  items: Array<{\r\n    item_id: number;\r\n    star: number;\r\n    count: number;\r\n  }>;\r\n}\r\n\r\nconst selectGroups = createSelector(\r\n  selectGroupMapByName,\r\n  map => {\r\n    if (!map) {\r\n      return null;\r\n    }\r\n\r\n    return RealmCardNames.map(name => [name, map.get(name)])\r\n      .filter(v => !!v[1])\r\n      .map(([name, items]) => {\r\n        return {\r\n          name,\r\n          items\r\n        };\r\n      }) as IRealmCardGroup[];\r\n  }\r\n);\r\n\r\nexport const RealmCardSelectors = {\r\n  selectGroups\r\n};\r\n","import React, { SFC, useState } from \"react\";\r\nimport \"./RealmCardPage.scss\";\r\nimport { connect } from \"react-redux\";\r\nimport { IYyxState } from \"../../store\";\r\nimport { RealmCardSelectors, IRealmCardGroup } from \"../../modules/realm_card\";\r\n\r\nconst Render: SFC<{\r\n  groups: IRealmCardGroup[] | null;\r\n}> = props => {\r\n  if (!props.groups) {\r\n    return null;\r\n  }\r\n\r\n  const columns = [];\r\n  const rows = [];\r\n  for (let i = 0; i < 6; i++) {\r\n    columns.push(<th key={i}>{6 - i}星</th>);\r\n  }\r\n\r\n  for (let g of props.groups) {\r\n    rows.push(\r\n      <tr key={g.name}>\r\n        <td>\r\n          <strong>{g.name}</strong>\r\n        </td>\r\n        {columns.map((c, idx) => {\r\n          const gi = g.items.find(i => i.star === 6 - idx);\r\n          return <td key={idx}>{gi ? gi.count : 0}</td>;\r\n        })}\r\n      </tr>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <table className=\"bp3-html-table bp3-html-table-striped\">\r\n        <thead>\r\n          <tr>\r\n            <th>结界卡</th>\r\n            {columns}\r\n          </tr>\r\n        </thead>\r\n        <tbody>{rows}</tbody>\r\n      </table>\r\n    </>\r\n  );\r\n};\r\n\r\nexport const RealmCardPage = connect((state: IYyxState) => ({\r\n  groups: RealmCardSelectors.selectGroups(state)\r\n}))(Render);\r\n","import React, { ReactElement, SFC, useState, useEffect, lazy } from \"react\";\r\nimport pkg from \"../../../package.json\";\r\nimport { HttpClient } from \"../../modules/http\";\r\nimport {\r\n  Popover,\r\n  Icon,\r\n  Spinner,\r\n  Intent,\r\n  Button,\r\n  Tag,\r\n  Divider\r\n} from \"@blueprintjs/core\";\r\nimport \"./UpdateInfo.scss\";\r\nconst os: string = require(\"platform\").os.family;\r\nconst Markdown = require(\"react-markdown\");\r\n\r\nconst MyTargets: string[] =\r\n  os === \"OS X\"\r\n    ? [\"macOS\"]\r\n    : os.includes(\"Windows\")\r\n    ? [\r\n        \"Windows\",\r\n        \"Windows-32bit\",\r\n        \"Windows-64bit\",\r\n        \"Steam\",\r\n        \"Facebook-Gameroom\"\r\n      ]\r\n    : [\"Ubuntu\", \"Debian\", \"Fedora\", \"Red Hat\"].some(v => os.includes(v))\r\n    ? [\"Linux\"]\r\n    : [];\r\n\r\nconst R_FILENAME = /^(yyx|yyx-snapshot)-(\\d+\\.\\d+.\\d+)-([^.]+)\\.(.+)$/;\r\n\r\nfunction getProxyUrl(url: string): string {\r\n  return url.replace(\r\n    \"https://github.com/OnmyojiX/yyx/\",\r\n    \"http://yyx.cloud/github/\"\r\n  );\r\n}\r\n\r\nfunction getAssetElement(asset: GithubAsset) {\r\n  const parts = asset.name.match(R_FILENAME);\r\n  if (!parts) {\r\n    return null;\r\n  }\r\n  const [_, product, version, target] = parts;\r\n  const myTarget = MyTargets.includes(target);\r\n  const productName = product === \"yyx\" ? \"痒痒熊主程序\" : \"痒痒熊快照\";\r\n  return (\r\n    <>\r\n      <a href={asset.browser_download_url} target=\"_blank\">\r\n        <Icon icon=\"download\" />\r\n        &nbsp;\r\n        {myTarget ? <strong>{productName}</strong> : productName}\r\n      </a>\r\n      &nbsp;\r\n      <Tag intent={Intent.PRIMARY} minimal={!myTarget}>\r\n        {target.replace(\"-\", \" \")}\r\n      </Tag>\r\n      &nbsp;v{version}\r\n    </>\r\n  );\r\n}\r\n\r\ninterface GithubAsset {\r\n  browser_download_url: string;\r\n  content_type: string;\r\n  name: string;\r\n  size: number;\r\n}\r\n\r\ninterface GithubRelease {\r\n  tag_name: string;\r\n  name: string;\r\n  published_at: string;\r\n  body: string;\r\n  assets: Array<GithubAsset>;\r\n  prerelease: boolean;\r\n  draft: boolean;\r\n}\r\n\r\nconst ReleaseInfo: SFC<{ release: GithubRelease }> = ({ release }) => {\r\n  return (\r\n    <div className=\"release-info\">\r\n      <h2>{release.name}</h2>\r\n      <p>\r\n        <small>v{release.tag_name}</small>\r\n      </p>\r\n      <Markdown source={release.body} />\r\n      <Divider />\r\n      <ul className=\"asset-list\">\r\n        {release.assets.map(a => (\r\n          <li key={a.browser_download_url}>{getAssetElement(a)}</li>\r\n        ))}\r\n      </ul>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const UpdateInfo: SFC = props => {\r\n  const [loading, setLoading] = useState<boolean>(true);\r\n  const [latest, setLatest] = useState<GithubRelease | null>(null);\r\n  const [error, setError] = useState<Error | null>(null);\r\n\r\n  useEffect(() => {\r\n    Promise.race([\r\n      HttpClient.get<GithubRelease>(\r\n        \"http://yyx.cloud/github-api/releases/latest\"\r\n      ).then(res => {\r\n        res.data.assets.forEach(\r\n          a => (a.browser_download_url = getProxyUrl(a.browser_download_url))\r\n        );\r\n        return res;\r\n      }),\r\n      HttpClient.get<GithubRelease>(\r\n        \"https://api.github.com/repos/OnmyojiX/yyx/releases/latest\"\r\n      )\r\n    ]).then(\r\n      res => {\r\n        if (res.data) {\r\n          if (\r\n            res.data.tag_name > pkg.version &&\r\n            !res.data.draft &&\r\n            !res.data.prerelease\r\n          ) {\r\n            setLatest(res.data);\r\n          }\r\n        }\r\n        setLoading(false);\r\n      },\r\n      err => {\r\n        setError(err);\r\n        setLoading(false);\r\n      }\r\n    );\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return <Spinner size={16} />;\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <a href=\"http://nga.178.com/read.php?tid=16557282\" target=\"_blank\">\r\n        检查更新\r\n      </a>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <span className=\"bp3-text-muted\">\r\n      {!latest && pkg.version}\r\n      {latest && (\r\n        <Popover defaultIsOpen={true}>\r\n          <Button minimal intent={Intent.PRIMARY}>\r\n            <Icon icon=\"info-sign\" />\r\n            &nbsp; <strong>有更新</strong>\r\n          </Button>\r\n          <ReleaseInfo release={latest} />\r\n        </Popover>\r\n      )}\r\n    </span>\r\n  );\r\n};\r\n","import \"./About.scss\";\r\nimport React, { ReactElement, SFC, useState, useEffect } from \"react\";\r\nimport logo from \"../../assets/logo.svg\";\r\nimport { Icon } from \"@blueprintjs/core\";\r\nimport pkg from \"../../../package.json\";\r\n\r\nexport const About: SFC = props => {\r\n  return (\r\n    <div className=\"about\">\r\n      <div className=\"yyx-layout row\">\r\n        <div className=\"item logo\">\r\n          <img width={100} height={100} src={logo} />\r\n          <br />\r\n          <small className=\"bp3-text-muted\">v{pkg.version}</small>\r\n        </div>\r\n        <div className=\"item content\">\r\n          <dl>\r\n            <dt>作者</dt>\r\n            <dd>海外加速区 | AD钙奶猫</dd>\r\n            <dt>NGA</dt>\r\n            <dd>\r\n              <a\r\n                target=\"_blank\"\r\n                href=\"http://nga.178.com/read.php?tid=16557282\"\r\n              >\r\n                链接 <Icon icon={\"link\"} />\r\n              </a>\r\n            </dd>\r\n            <dt>GitHub</dt>\r\n            <dd>\r\n              <a target=\"_blank\" href=\"https://github.com/OnmyojiX/yyx\">\r\n                链接 <Icon icon={\"link\"} />\r\n              </a>\r\n            </dd>\r\n            <dt>QQ群</dt>\r\n            <dd>496107455</dd>\r\n            <dt>微博</dt>\r\n            <dd>\r\n              <a\r\n                target=\"_blank\"\r\n                href=\"https://www.weibo.com/p/1005056044720097/home\"\r\n              >\r\n                链接 <Icon icon={\"link\"} />\r\n              </a>\r\n            </dd>\r\n          </dl>\r\n\r\n          <h2 className=\"important\">求赞</h2>\r\n          <div className=\"important\">\r\n            请给我老婆 <strong>AD钙奶熊</strong> 点赞\r\n          </div>\r\n          <div className=\"important\">\r\n            请给我老婆 <strong>AD钙奶熊</strong> 点赞\r\n          </div>\r\n          <div className=\"important\">\r\n            请给我老婆 <strong>AD钙奶熊</strong> 点赞\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React, { SFC, ComponentClass } from \"react\";\r\nimport \"./Main.scss\";\r\nimport logo from \"../../assets/logo.svg\";\r\n\r\nimport {\r\n  Alignment,\r\n  Button,\r\n  Classes,\r\n  Navbar,\r\n  NavbarDivider,\r\n  NavbarGroup,\r\n  ButtonGroup,\r\n  Popover\r\n} from \"@blueprintjs/core\";\r\n\r\nimport {\r\n  BrowserRouter as Router,\r\n  Route,\r\n  Link,\r\n  RouteComponentProps,\r\n  withRouter\r\n} from \"react-router-dom\";\r\nimport { YyxStore } from \"../../store\";\r\nimport { SnapshotActions } from \"../../modules/snapshot\";\r\nimport { OverviewPage } from \"../Overview/OverviewPage\";\r\nimport { SnapshotInfo } from \"../Snapshot/SnapshotInfo\";\r\nimport { ISnapshot } from \"../../interfaces\";\r\n\r\nimport { HeroPage } from \"../Hero/HeroPage\";\r\nimport { EquipPage } from \"../Equip/EquipPage\";\r\nimport { RealmCardPage } from \"../RealmCard/RealmCardPage\";\r\nimport { UpdateInfo } from \"../Update/UpdateInfo\";\r\nimport { About } from \"../About/About\";\r\n\r\nconst routes = [\r\n  {\r\n    path: \"/\",\r\n    component: OverviewPage,\r\n    renderLabel: () => \"概况\"\r\n  },\r\n  {\r\n    path: \"/hero\",\r\n    component: HeroPage,\r\n    renderLabel: (snapshot: ISnapshot) =>\r\n      `式神 (${snapshot.data.heroes.length})`\r\n  },\r\n  {\r\n    path: \"/equip\",\r\n    component: EquipPage,\r\n    renderLabel: (snapshot: ISnapshot) =>\r\n      `御魂 (${snapshot.data.hero_equips.length})`\r\n  },\r\n  {\r\n    path: \"/realm-card\",\r\n    component: RealmCardPage,\r\n    renderLabel: (snapshot: ISnapshot) =>\r\n      `结界卡 (${snapshot.data.realm_cards.length})`\r\n  }\r\n];\r\n\r\nconst Render: SFC<RouteComponentProps> = props => {\r\n  const path = props.location.pathname;\r\n  return (\r\n    <main>\r\n      <Navbar>\r\n        <NavbarGroup align={Alignment.LEFT}>\r\n          <a className=\"navbar-left\">\r\n            <img className=\"logo\" src={logo} />\r\n          </a>\r\n          <NavbarDivider />\r\n          <SnapshotInfo\r\n            render={info =>\r\n              info && (\r\n                <>\r\n                  <span>{info.data.player.name}</span>\r\n                  <NavbarDivider />\r\n                  <ButtonGroup large>\r\n                    {routes.map((r, i) => (\r\n                      <Button\r\n                        key={i}\r\n                        onClick={() => props.history.push(r.path)}\r\n                        active={\r\n                          r.path === \"/\"\r\n                            ? path === \"/\"\r\n                            : path.startsWith(r.path)\r\n                        }\r\n                        text={r.renderLabel(info)}\r\n                      />\r\n                    ))}\r\n                  </ButtonGroup>\r\n                </>\r\n              )\r\n            }\r\n          />\r\n        </NavbarGroup>\r\n        <NavbarGroup align={Alignment.RIGHT}>\r\n          <UpdateInfo />\r\n          <NavbarDivider />\r\n          <Popover>\r\n            <Button minimal>关于</Button>\r\n            <About />\r\n          </Popover>\r\n          <NavbarDivider />\r\n          <Button\r\n            icon=\"folder-open\"\r\n            onClick={() => {\r\n              YyxStore.dispatch(SnapshotActions.resetCurrent());\r\n            }}\r\n          >\r\n            打开其他快照\r\n          </Button>\r\n        </NavbarGroup>\r\n      </Navbar>\r\n      <div className=\"yyx-container\">\r\n        {routes.map((route, i) => (\r\n          <Route\r\n            key={i}\r\n            path={route.path}\r\n            exact={route.path === \"/\"}\r\n            component={route.component}\r\n          />\r\n        ))}\r\n      </div>\r\n    </main>\r\n  );\r\n};\r\n\r\nconst LayoutImpl = withRouter(Render);\r\n\r\nexport const Main: SFC = props => {\r\n  return (\r\n    <Router>\r\n      <LayoutImpl {...props} />\r\n    </Router>\r\n  );\r\n};\r\n","import React, { SFC, ChangeEvent, FormEventHandler, useState } from \"react\";\r\nimport \"./SnapshotSelectScreen.scss\";\r\nimport logo from \"../../assets/logo.svg\";\r\nimport { FileInput, Callout, Spinner } from \"@blueprintjs/core\";\r\nimport { YyxStore, IDispatch } from \"../../store\";\r\nimport { SnapshotActions } from \"../../modules/snapshot\";\r\nimport { connect } from \"react-redux\";\r\n\r\nconst SnapshotSelectScreenImpl: SFC<{\r\n  dispatch: IDispatch;\r\n}> = props => {\r\n  const [error, setError] = useState<Error | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const handleSelectFile: FormEventHandler<HTMLInputElement> = e => {\r\n    const { files } = e.target as any;\r\n    if (files.length) {\r\n      setError(null);\r\n      setLoading(true);\r\n      props\r\n        .dispatch(SnapshotActions.select(files[0]))\r\n        // .finally(() => setLoading(false))\r\n        .catch((err: Error) => {\r\n          setLoading(false);\r\n          setError(err);\r\n        });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"snapshot-select-screen\">\r\n      <div className=\"bp3-non-ideal-state\">\r\n        <div className=\"bp3-non-ideal-state-visual\">\r\n          <img src={logo} className=\"logo\" />\r\n        </div>\r\n        <h4 className=\"bp3-heading\">痒痒熊</h4>\r\n        <div className=\"bp3-text-small bp3-text-muted\">\r\n          痒痒鼠超厉害的的小伙伴。\r\n        </div>\r\n        {error && (\r\n          <Callout title=\"打开快照失败\" intent=\"danger\">\r\n            {error.message}\r\n          </Callout>\r\n        )}\r\n        {loading ? (\r\n          <Spinner />\r\n        ) : (\r\n          <FileInput\r\n            text=\"选择快照文件\"\r\n            onInputChange={handleSelectFile}\r\n            large\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const SnapshotSelectScreen = connect()(SnapshotSelectScreenImpl);\r\n","import React, { SFC, useEffect } from \"react\";\r\nimport \"./App.scss\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport { IYyxState } from \"../store\";\r\n\r\nimport { Main } from \"./Main/Main\";\r\nimport { SnapshotSelectScreen } from \"./Snapshot/SnapshotSelectScreen\";\r\n\r\nimport { SnapshotActions } from \"../modules/snapshot\";\r\nimport { ISnapshot } from \"../interfaces\";\r\nimport { Spinner } from \"@blueprintjs/core\";\r\n\r\nconst AppRender: SFC<{\r\n  snapshot: ISnapshot | null;\r\n  notSelected: boolean;\r\n  load: () => void;\r\n}> = props => {\r\n  useEffect(() => {\r\n    props.load();\r\n  }, []);\r\n\r\n  let main;\r\n\r\n  if (props.snapshot) {\r\n    main = <Main />;\r\n  } else {\r\n    if (props.notSelected) {\r\n      main = <SnapshotSelectScreen />;\r\n    } else {\r\n      main = (\r\n        <div style={{ marginTop: \"20%\" }}>\r\n          <Spinner />\r\n        </div>\r\n      );\r\n    }\r\n  }\r\n\r\n  return <>{main}</>;\r\n};\r\n\r\nconst App = connect(\r\n  (state: IYyxState) => {\r\n    return {\r\n      snapshot: state.snapshot.current,\r\n      notSelected: state.snapshot.currentNotSelected\r\n    };\r\n  },\r\n  dispatch => {\r\n    return {\r\n      load: () => dispatch(SnapshotActions.loadCurrent() as any)\r\n    };\r\n  }\r\n)(AppRender);\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read http://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\n\r\nimport \"./styles/yyx.scss\";\r\n\r\nimport { Provider } from \"react-redux\";\r\nimport App from \"./components/App\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\nimport { YyxStore } from \"./store\";\r\n\r\nconst container = document.getElementById(\"root\") as HTMLElement;\r\n\r\nReactDOM.render(\r\n  <Provider store={YyxStore}>\r\n    <App />\r\n  </Provider>,\r\n  container\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: http://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","module.exports = __webpack_public_path__ + \"static/media/logo.e6addb46.svg\";"],"sourceRoot":""}